#SQL[@2,N92]Error[47]
select load_file(cast('file://$resources/file_test/normal.txt?offset=0&size=a' as datalink));
strconv.ParseInt: parsing \"a\": invalid syntax

#SQL[@3,N92]Error[47]
select load_file(cast('file://$resources/file_test/normal.txt?offset=b&size=3' as datalink));
strconv.ParseInt: parsing \"b\": invalid syntax

#SQL[@6,N76]Result[99, 12]
select load_file(cast('file://$resources/file_test/normal.txt' as datalink));
load_file(cast(file:///root/matrixone/test/distributed/resources/file_test/normal.txt as datalink))
Hello world!

#SQL[@7,N92]Result[115, 3]
select load_file(cast('file://$resources/file_test/normal.txt?offset=0&size=3' as datalink));
load_file(cast(file:///root/matrixone/test/distributed/resources/file_test/normal.txt?offset=0&size=3 as datalink))
Hel

#SQL[@10,N34]Result[]
create table t1(a int, b datalink);

#SQL[@13,N46]Error[46]
insert into t1 values(1, "wrong datalink url");
unsupported url scheme  is not yet implemented

#SQL[@14,N65]Error[49]
insert into t1 values(2, 'git://repo/normal.txt?offset=0&size=3');
unsupported url scheme git is not yet implemented

#SQL[@17,N82]Result[]
insert into t1 values(1, 'file://$resources/file_test/normal.txt?offset=0&size=3');

#SQL[@18,N66]Result[]
insert into t1 values(2, 'file://$resources/file_test/normal.txt');

#SQL[@21,N73]Result[]
insert into t1 values(3, 'file://$resources/file_test/normal.txt?size=3');

#SQL[@24,N75]Result[]
insert into t1 values(4, 'file://$resources/file_test/normal.txt?offset=0');

#SQL[@27,N85]Error[43]
insert into t1 values(5, 'file://$resources/file_test/normal.txt?offset=0&size=-100');
internal error: size cannot be less than -1

#SQL[@29,N30]Result[19, 10, 19, 10, 19]
select a, load_file(b) from t1;
a  ¦  load_file(b)
1  ¦  Hel
2  ¦  Hello world!
3  ¦  Hel
4  ¦  Hello world!

#SQL[@32,N57]Result[]
create stage filestage URL='file://$resources/file_test/';

#SQL[@33,N63]Result[]
create stage outfilestage URL='file://$resources/into_outfile/';

#SQL[@36,N66]Result[57, 12]
select load_file(cast('stage://filestage/normal.txt' as datalink));
load_file(cast(stage://filestage/normal.txt as datalink))
Hello world!

#SQL[@37,N82]Result[73, 3]
select load_file(cast('stage://filestage/normal.txt?offset=0&size=3' as datalink));
load_file(cast(stage://filestage/normal.txt?offset=0&size=3 as datalink))
Hel

#SQL[@41,N92]Result[81, 2]
select save_file(cast('stage://outfilestage/datalink/1.txt' as datalink), 'this is a test.');
save_file(cast(stage://outfilestage/datalink/1.txt as datalink), this is a test.)
15

#SQL[@42,N73]Result[64, 15]
select load_file(cast('stage://outfilestage/datalink/1.txt' as datalink));
load_file(cast(stage://outfilestage/datalink/1.txt as datalink))
this is a test.

#SQL[@45,N102]Result[123, 2]
select save_file(cast('file://$resources/into_outfile/datalink/2.txt' as datalink), 'this is a test.');
save_file(cast(file:///root/matrixone/test/distributed/resources/into_outfile/datalink/2.txt as datalink), this is a test.)
15

#SQL[@46,N83]Result[106, 15]
select load_file(cast('file://$resources/into_outfile/datalink/2.txt' as datalink));
load_file(cast(file:///root/matrixone/test/distributed/resources/into_outfile/datalink/2.txt as datalink))
this is a test.

#SQL[@49,N45]Result[]
create table t2(a int, b datalink, c varchar);

#SQL[@50,N327]Result[]
insert into t2 values(1, cast('stage://outfilestage/datalink/varchar1.txt' as datalink), 'this is a varchar test 1'),
(2, cast('stage://outfilestage/datalink/varchar2.txt' as datalink), 'this is a varchar test 2'),
(3, cast('stage://outfilestage/datalink/varchar3.txt' as datalink), NULL),
(4, NULL, 'this is a varchar test 4');

#SQL[@55,N33]Result[22, 9, 9, 11, 11]
select a, save_file(b, c) from t2;
a  ¦  save_file(b, c)
1  ¦  24
2  ¦  24
3  ¦  null
4  ¦  null

#SQL[@57,N47]Result[]
create table t3(a int, b datalink, c char(128));

#SQL[@58,N309]Result[]
insert into t3 values(1, cast('stage://outfilestage/datalink/char1.txt' as datalink), 'this is a char test 1'),
(2, cast('stage://outfilestage/datalink/char2.txt' as datalink), 'this is a char test 2'),
(3, cast('stage://outfilestage/datalink/char3.txt' as datalink), NULL),
(4, NULL, 'this is a char test 4');

#SQL[@63,N33]Result[22, 9, 9, 11, 11]
select a, save_file(b, c) from t3;
a  ¦  save_file(b, c)
1  ¦  21
2  ¦  21
3  ¦  null
4  ¦  null

#SQL[@65,N42]Result[]
create table t4(a int, b datalink, c text);

#SQL[@66,N309]Result[]
insert into t4 values(1, cast('stage://outfilestage/datalink/text1.txt' as datalink), 'this is a text test 1'),
(2, cast('stage://outfilestage/datalink/text2.txt' as datalink), 'this is a text test 2'),
(3, cast('stage://outfilestage/datalink/text3.txt' as datalink), NULL),
(4, NULL, 'this is a text test 4');

#SQL[@71,N33]Result[22, 9, 9, 11, 11]
select a, save_file(b, c) from t4;
a  ¦  save_file(b, c)
1  ¦  21
2  ¦  21
3  ¦  null
4  ¦  null

#SQL[@74,N51]Error[57]
select cast(cast('file://xxx' as bool) as datalink);
invalid argument operator cast, bad value [BOOL DATALINK]

#SQL[@75,N53]Error[59]
select cast(cast('file://xxx' as bigint) as datalink);
invalid argument operator cast, bad value [BIGINT DATALINK]

#SQL[@76,N50]Error[56]
select cast(cast('file://xxx' as int) as datalink);
invalid argument operator cast, bad value [INT DATALINK]

#SQL[@77,N52]Error[58]
select cast(cast('file://xxx' as float) as datalink);
invalid argument operator cast, bad value [FLOAT DATALINK]

#SQL[@78,N65]Error[57]
select cast(cast(cast('file://xxx' as char) as datalink) as bool);
invalid argument operator cast, bad value [DATALINK BOOL]

#SQL[@79,N67]Error[59]
select cast(cast(cast('file://xxx' as char) as datalink) as bigint);
invalid argument operator cast, bad value [DATALINK BIGINT]

#SQL[@80,N64]Error[56]
select cast(cast(cast('file://xxx' as char) as datalink) as int);
invalid argument operator cast, bad value [DATALINK INT]

#SQL[@84,N53]Result[44, 10]
select cast(cast('file://xxx' as binary) as datalink);
cast(cast(file://xxx as binary) as datalink)
file://xxx

#SQL[@85,N54]Result[45, 10]
select cast(cast('file://xxx' as varchar) as datalink);
cast(cast(file://xxx as varchar) as datalink)
file://xxx

#SQL[@86,N51]Result[45, 10]
select cast(cast('file://xxx' as char) as datalink);
cast(cast(file://xxx as varchar) as datalink)
file://xxx

#SQL[@87,N51]Result[42, 10]
select cast(cast('file://xxx' as text) as datalink);
cast(cast(file://xxx as text) as datalink)
file://xxx

#SQL[@88,N65]Result[59, 10]
select cast(cast(cast('file://xxx' as char) as datalink) as text);
cast(cast(cast(file://xxx as varchar) as datalink) as text)
file://xxx

#SQL[@89,N68]Result[62, 10]
select cast(cast(cast('file://xxx' as char) as datalink) as varchar);
cast(cast(cast(file://xxx as varchar) as datalink) as varchar)
file://xxx

#SQL[@90,N65]Result[62, 10]
select cast(cast(cast('file://xxx' as char) as datalink) as char);
cast(cast(cast(file://xxx as varchar) as datalink) as varchar)
file://xxx

#SQL[@95,N20]Result[]
drop stage filestage;

#SQL[@96,N23]Result[]
drop stage outfilestage;

