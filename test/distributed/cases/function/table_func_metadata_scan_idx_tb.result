#SQL[@1,N84]Error[60]
select * from metadata_scan('table_func_metadata_scan_idx_tb.no_exist_table', '*') g;
no such table table_func_metadata_scan_idx_tb.no_exist_table

#SQL[@2,N22]Result[]
drop table if exists t;

#SQL[@3,N74]Result[]
create table t(a int, b varchar, c float, d decimal(10, 8), e float(5, 2));

#SQL[@4,N43]Result[]
insert into t values(1, null, 1.1, 1, 1.11);

#SQL[@5,N44]Result[]
insert into t values(2, "abc", 2.0, 2, 2.22);

#SQL[@6,N29]Result[]
insert into t select * from t;

#SQL[@7,N29]Result[]
insert into t select * from t;

#SQL[@8,N29]Result[]
insert into t select * from t;

#SQL[@9,N29]Result[]
insert into t select * from t;

#SQL[@10,N29]Result[]
insert into t select * from t;

#SQL[@11,N29]Result[]
insert into t select * from t;

#SQL[@12,N29]Result[]
insert into t select * from t;

#SQL[@13,N29]Result[]
insert into t select * from t;

#SQL[@14,N29]Result[]
insert into t select * from t;

#SQL[@15,N29]Result[]
insert into t select * from t;

#SQL[@16,N29]Result[]
insert into t select * from t;

#SQL[@17,N29]Result[]
insert into t select * from t;

#SQL[@18,N22]Result[8, 4]
select count(*) from t;
count(*)
8192

#SQL[@19,N65]Result[52, 79]
select mo_ctl("dn", "flush", "table_func_metadata_scan_idx_tb.t");
mo_ctl(dn, flush, table_func_metadata_scan_idx_tb.t)
{
  "method": "Flush",
  "result": [
    {
      "returnStr": "OK"
    }
  ]
}


#SQL[@21,N26]Result[]
CREATE INDEX idx_a ON t(a);

#SQL[@22,N94]Result[8, 18, 18]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.?idx_a", "*")g;
col_name
__mo_index_idx_col
__mo_index_pri_col

#SQL[@23,N31]Result[]
CREATE INDEX idx_c_d ON t(c, d);

#SQL[@24,N96]Result[8, 18, 18]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.?idx_c_d", "*")g;
col_name
__mo_index_idx_col
__mo_index_pri_col

#SQL[@25,N100]Error[69]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.?idx_invalid", "*")g;
internal error: check whether the index \"idx_invalid\" really exists

#SQL[@26,N99]Error[72]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.idx_invalid", "*")g;
internal error: index name must start with ? and follow identifier rules

#SQL[@28,N102]Error[69]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.?idx_invalid.#", "*")g;
internal error: check whether the index \"idx_invalid\" really exists

#SQL[@29,N96]Result[]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.?idx_a.#", "*")g;

#SQL[@30,N89]Result[]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.#", "*")g;

#SQL[@31,N25]Result[]
delete from t where a = 1;

#SQL[@32,N22]Result[8, 4]
select count(*) from t;
count(*)
4096

#SQL[@33,N89]Result[8, 1, 1, 1, 1, 1]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.#", "*")g;
col_name
a
b
c
d
e

#SQL[@34,N96]Result[8, 18, 18]
select distinct(col_name) from metadata_scan("table_func_metadata_scan_idx_tb.t.?idx_a.#", "*")g;
col_name
__mo_index_idx_col
__mo_index_pri_col

