#SQL[@6,N26]Result[]
drop table if exists names;

#SQL[@7,N64]Result[]
create table names(id int PRIMARY KEY,name VARCHAR(255),age int);

#SQL[@8,N54]Result[]
replace into names(id, name, age) values(1,"Abby", 24);

#SQL[@9,N40]Result[13, 12]
select name, age from names where id = 1;
name  ¦  age
Abby  ¦  24

#SQL[@10,N55]Result[]
replace into names(id, name, age) values(1,"Bobby", 25);

#SQL[@11,N40]Result[13, 13]
select name, age from names where id = 1;
name  ¦  age
Bobby  ¦  25

#SQL[@12,N44]Result[]
replace into names set id = 2, name = "Ciro";

#SQL[@13,N40]Result[13, 14]
select name, age from names where id = 2;
name  ¦  age
Ciro  ¦  null

#SQL[@14,N54]Result[]
replace into names set id = 2, name = "Ciro", age = 17;

#SQL[@15,N40]Result[13, 12]
select name, age from names where id = 2;
name  ¦  age
Ciro  ¦  17

#SQL[@16,N40]Result[]
REPLACE INTO names values (2, "Bob", 19);

#SQL[@17,N40]Result[13, 11]
select name, age from names where id = 2;
name  ¦  age
Bob  ¦  19

#SQL[@18,N59]Result[]
/* comment */ replace into names set id = 2, name = "Dylan";

#SQL[@19,N40]Result[13, 15]
select name, age from names where id = 2;
name  ¦  age
Dylan  ¦  null

#SQL[@21,N23]Result[]
drop table if exists t1;

#SQL[@22,N36]Result[]
create table t1(a int, b int, c int);

#SQL[@23,N47]Result[]
insert into t1 values (1,1,1), (2,2,2), (3,3,3);

#SQL[@24,N34]Result[]
replace t1 values (1,2,3), (2,3,4);

#SQL[@25,N22]Result[15, 15, 15, 15, 15, 15]
select a, b, c from t1;
a  ¦  b  ¦  c
1  ¦  1  ¦  1
2  ¦  2  ¦  2
3  ¦  3  ¦  3
1  ¦  2  ¦  3
2  ¦  3  ¦  4

#SQL[@26,N49]Result[]
create table t4 (a int unique key, b varchar(64));

#SQL[@27,N31]Result[]
replace into t4 values (1, 'a');

#SQL[@28,N16]Result[8, 8]
select * from t4;
a  ¦  b
1  ¦  a

#SQL[@29,N31]Result[]
replace into t4 values (1, 'b');

#SQL[@30,N16]Result[8, 8]
select * from t4;
a  ¦  b
1  ¦  b

#SQL[@32,N23]Result[]
drop table if exists t1;

#SQL[@33,N72]Result[]
create table t1(a int primary key, b int unique, c varchar(255), key(c));

#SQL[@34,N42]Result[]
insert into t1 values (1,1,"1"), (2,2,"2");

#SQL[@35,N16]Result[15, 15, 15]
select * from t1;
a  ¦  b  ¦  c
1  ¦  1  ¦  1
2  ¦  2  ¦  2

#SQL[@36,N43]Result[]
replace into t1 values (1,4,"4"), (3,3,"3");

#SQL[@37,N16]Result[15, 15, 15, 15]
select * from t1;
a  ¦  b  ¦  c
2  ¦  2  ¦  2
1  ¦  4  ¦  4
3  ¦  3  ¦  3

#SQL[@39,N26]Result[]
create database replace_db;

#SQL[@40,N14]Result[]
use replace_db;

#SQL[@41,N54]Result[]
replace into `replace`.`names` values (2, "Dylan", 20);

#SQL[@42,N52]Result[13, 13]
select name, age from `replace`.`names` where id = 2;
name  ¦  age
Dylan  ¦  20

#SQL[@44,N22]Result[]
drop table if exists c;

#SQL[@45,N54]Result[]
create table c(a int primary key , b int, v vecf32(3));

#SQL[@46,N36]Result[]
replace into c values(1,1,'[1,2,3]');

#SQL[@47,N15]Result[15, 23]
select * from c;
a  ¦  b  ¦  v
1  ¦  1  ¦  [1, 2, 3]

#SQL[@48,N12]Result[]
drop table c;

#SQL[@49,N22]Result[]
drop table if exists c;

#SQL[@50,N54]Result[]
create table c(a int primary key , b int, v vecf32(3));

#SQL[@51,N36]Result[]
replace into c values(1,1,'[1,2,3]');

#SQL[@52,N22]Result[]
drop table if exists f;

#SQL[@53,N61]Result[]
create table f (a int primary key, b int, c int, v vecf32(3));

#SQL[@54,N192]Result[]
replace into f with c1 as (select * from c), src as (select * from (values row(1,1, cast('[3,4,5]' as vecf32(3))))) select a, column_0, column_1, column_2 from c1,src where c1.a = src.column_0;

#SQL[@55,N12]Result[]
drop table f;

#SQL[@56,N12]Result[]
drop table c;

#SQL[@58,N30]Result[]
set experimental_ivf_index = 1;

#SQL[@59,N223]Result[]
create table bug_22340 (a int not null auto_increment, a1 int default null, b vecf64(3) DEFAULT NULL COMMENT 'document向量化信息', PRIMARY KEY (`a`), KEY `idx_vec` USING ivfflat (`b`) lists = 1 op_type 'vector_l2_ops');

#SQL[@60,N230]Result[]
REPLACE INTO bug_22340 VALUES (1,100,'[1, 2, 3]'),(2,100,'[1, 2, 3]'),(3,100,'[1, 2, 3]'),(4,100,'[1, 2, 3]'),(5,100,'[1, 2, 3]'),(6,100,'[1, 2, 3]'),(7,100,'[1, 2, 3]'),(8,100,'[1, 2, 3]'),(9,100,'[1, 2, 3]'),(10,100,'[1, 2, 3]');

#SQL[@62,N50]Result[39, 79]
select mo_ctl('dn','flush','replace_db.bug_22340');
mo_ctl(dn, flush, replace_db.bug_22340)
{
  "method": "Flush",
  "result": [
    {
      "returnStr": "OK"
    }
  ]
}


#SQL[@63,N230]Result[]
REPLACE INTO bug_22340 VALUES (1,100,'[1, 2, 3]'),(2,100,'[1, 2, 3]'),(3,100,'[1, 2, 3]'),(4,100,'[1, 2, 3]'),(5,100,'[1, 2, 3]'),(6,100,'[1, 2, 3]'),(7,100,'[1, 2, 3]'),(8,100,'[1, 2, 3]'),(9,100,'[1, 2, 3]'),(10,100,'[1, 2, 3]');

#SQL[@64,N20]Result[]
drop table bug_22340;

#SQL[@65,N30]Result[]
set experimental_ivf_index = 0;

#SQL[@67,N24]Result[]
drop database replace_db;

