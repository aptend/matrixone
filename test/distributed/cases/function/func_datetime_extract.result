#SQL[@3,N47]Result[34, 4]
select extract(YEAR FROM "1999-01-02 10:11:12");
extract(year, 1999-01-02 10:11:12)
1999

#SQL[@4,N44]Result[31, 6]
select extract(YEAR_MONTH FROM "1999-01-02");
extract(year_month, 1999-01-02)
199901

#SQL[@5,N37]Result[24, 2]
select extract(DAY FROM "1999-01-02");
extract(day, 1999-01-02)
02

#SQL[@6,N51]Result[38, 5]
select extract(DAY_HOUR FROM "1999-01-02 10:11:12");
extract(day_hour, 1999-01-02 10:11:12)
02 10

#SQL[@7,N47]Result[34, 2]
select extract(HOUR FROM "1999-01-02 10:11:12");
extract(hour, 1999-01-02 10:11:12)
10

#SQL[@8,N49]Result[36, 2]
select extract(SECOND FROM "1999-01-02 10:11:12");
extract(second, 1999-01-02 10:11:12)
12

#SQL[@9,N39]Error[29]
select extract(MONTH FROM "2001-02-00");
internal error: invalid input

#SQL[@10,N44]Result[31, 2]
select extract(HOUR FROM "2023-11-08 15:00");
extract(hour, 2023-11-08 15:00)
15

#SQL[@14,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-01-15') AS quarter;
quarter
1

#SQL[@15,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-02-15') AS quarter;
quarter
1

#SQL[@16,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-03-15') AS quarter;
quarter
1

#SQL[@17,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-04-15') AS quarter;
quarter
2

#SQL[@18,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-05-15') AS quarter;
quarter
2

#SQL[@19,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-06-15') AS quarter;
quarter
2

#SQL[@20,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-07-15') AS quarter;
quarter
3

#SQL[@21,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-08-15') AS quarter;
quarter
3

#SQL[@22,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-09-15') AS quarter;
quarter
3

#SQL[@23,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-10-15') AS quarter;
quarter
4

#SQL[@24,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-11-15') AS quarter;
quarter
4

#SQL[@25,N52]Result[7, 1]
SELECT EXTRACT(QUARTER FROM '2004-12-15') AS quarter;
quarter
4

#SQL[@29,N31]Result[20, 4]
select extract(month from NULL);
extract(month, null)
null

#SQL[@32,N31]Result[]
create table t1(a INT,  b date);

#SQL[@33,N31]Result[]
create table t2(a INT,  b date);

#SQL[@34,N92]Result[]
insert into t1 values(1, "2012-10-12"),(2, "2004-04-24"),(3, "2008-12-04"),(4, "2012-03-23");

#SQL[@35,N92]Result[]
insert into t2 values(1, "2013-04-30"),(2, "1994-10-04"),(3, "2018-06-04"),(4, "2012-10-12");

#SQL[@36,N88]Result[8, 8, 8]
SELECT t1.a, t2.a FROM t1 JOIN t2 ON (extract(year from t1.b) = extract(year from t2.b));
a  ¦  a
1  ¦  4
4  ¦  4

#SQL[@37,N13]Result[]
drop table t1;

#SQL[@38,N13]Result[]
drop table t2;

#SQL[@42,N35]Result[]
create table t1 (ctime varchar(20));

#SQL[@43,N69]Result[]
insert into t1 values ('2001-01-12 12:23:40'),('2002-03-12 12:23:40');

#SQL[@44,N92]Result[5, 19]
select ctime from t1 where extract(MONTH FROM ctime) = 1 AND extract(YEAR FROM ctime) = 2001;
ctime
2001-01-12 12:23:40

#SQL[@45,N56]Result[5, 19]
select ctime from t1 where extract(MONTH FROM ctime) > 2;
ctime
2002-03-12 12:23:40

#SQL[@46,N13]Result[]
drop table t1;

#SQL[@49,N36]Result[]
CREATE TABLE t1 (i1 INT,d1 DATETIME);

#SQL[@52,N59]Result[]
INSERT INTO t1 SELECT MAX(1), "2023-04-23 08:23:21" FROM t1;

#SQL[@53,N82]Result[65, 24]
SELECT i1, EXTRACT(YEAR FROM "2023-04-23 08:23:21"), EXTRACT(YEAR FROM d1) FROM t1;
i1  ¦  EXTRACT(year, 2023-04-23 08:23:21)  ¦  EXTRACT(year, d1)
null  ¦  2023  ¦  2023

#SQL[@54,N13]Result[]
DROP TABLE t1;

#SQL[@59,N45]Result[32, 4]
select extract(DAY_MINUTE FROM "02 10:11:12");
extract(day_minute, 02 10:11:12)
5811

#SQL[@60,N46]Result[33, 8]
select extract(DAY_SECOND FROM "225 10:11:12");
extract(day_second, 225 10:11:12)
54101112

#SQL[@61,N43]Result[30, 4]
select extract(HOUR_MINUTE FROM "10:11:12");
extract(hour_minute, 10:11:12)
1011

#SQL[@62,N43]Result[30, 6]
select extract(HOUR_SECOND FROM "10:11:12");
extract(hour_second, 10:11:12)
101112

#SQL[@63,N38]Result[25, 2]
select extract(MINUTE FROM "10:11:12");
extract(minute, 10:11:12)
11

#SQL[@64,N45]Result[32, 4]
select extract(MINUTE_SECOND FROM "10:11:12");
extract(minute_second, 10:11:12)
1112

#SQL[@67,N40]Result[27, 6]
SELECT EXTRACT(HOUR FROM '100000:02:03');
EXTRACT(hour, 100000:02:03)
100000

#SQL[@70,N58]Result[46, 4]
select reverse(concat_ws(",",extract(year from 20090702)));
reverse(concat_ws(,, extract(year, 20090702)))
9002

#SQL[@72,N62]Result[]
create table t1 (d date, dt datetime, t timestamp, c char(10));

#SQL[@73,N85]Error[48]
insert ignore into t1 values ("0000-00-00", "0000-00-00", "0000-00-00", "0000-00-00");
invalid argument parsedate, bad value 0000-00-00

#SQL[@74,N136]Result[]
select extract(MONTH FROM "0000-00-00"),extract(MONTH FROM d),extract(MONTH FROM dt),extract(MONTH FROM t),extract(MONTH FROM c) from t1;

#SQL[@75,N13]Result[]
drop table t1;

#SQL[@77,N36]Result[]
CREATE TABLE t1 (i1 INT,d1 DATETIME);

#SQL[@78,N47]Result[]
INSERT INTO t1 values(1, "2023-04-23 08:23:21");

#SQL[@79,N40]Result[25, 9]
SELECT i1, EXTRACT(HOUR FROM d1) FROM t1;
i1  ¦  EXTRACT(hour, d1)
1  ¦  08

#SQL[@80,N13]Result[]
DROP TABLE t1;

#SQL[@84,N105]Result[]
CREATE TABLE t1
(`date` date,
`extracted_week` int,
`weekday` int,
`week` int,
`default_week_format` int);

#SQL[@90,N113]Result[]
INSERT INTO t1 SELECT '2000-01-01', EXTRACT(WEEK FROM '2000-01-01'), weekday('2000-01-01'), WEEK('2000-01-01'), 1;

#SQL[@91,N113]Result[]
INSERT INTO t1 SELECT '2000-01-01', EXTRACT(WEEK FROM '2000-01-01'), weekday('2000-01-01'), WEEK('2000-01-01'), 2;

#SQL[@92,N113]Result[]
INSERT INTO t1 SELECT '2000-01-01', EXTRACT(WEEK FROM '2000-01-01'), weekday('2000-01-01'), WEEK('2000-01-01'), 3;

#SQL[@93,N113]Result[]
INSERT INTO t1 SELECT '2000-01-01', EXTRACT(WEEK FROM '2000-01-01'), weekday('2000-01-01'), WEEK('2000-01-01'), 4;

#SQL[@94,N113]Result[]
INSERT INTO t1 SELECT '2000-01-01', EXTRACT(WEEK FROM '2000-01-01'), weekday('2000-01-01'), WEEK('2000-01-01'), 5;

#SQL[@95,N113]Result[]
INSERT INTO t1 SELECT '2000-01-01', EXTRACT(WEEK FROM '2000-01-01'), weekday('2000-01-01'), WEEK('2000-01-01'), 6;

#SQL[@96,N113]Result[]
INSERT INTO t1 SELECT '2000-01-01', EXTRACT(WEEK FROM '2000-01-01'), weekday('2000-01-01'), WEEK('2000-01-01'), 7;

#SQL[@97,N113]Result[]
INSERT INTO t1 SELECT '2000-01-01', EXTRACT(WEEK FROM '2000-01-01'), weekday('2000-01-01'), WEEK('2000-01-01'), 0;

#SQL[@98,N16]Result[72, 40, 40, 40, 40, 40, 40, 40, 40]
SELECT * FROM t1;
date  ¦  extracted_week  ¦  weekday  ¦  week  ¦  default_week_format
2000-01-01  ¦  52  ¦  5  ¦  52  ¦  1
2000-01-01  ¦  52  ¦  5  ¦  52  ¦  2
2000-01-01  ¦  52  ¦  5  ¦  52  ¦  3
2000-01-01  ¦  52  ¦  5  ¦  52  ¦  4
2000-01-01  ¦  52  ¦  5  ¦  52  ¦  5
2000-01-01  ¦  52  ¦  5  ¦  52  ¦  6
2000-01-01  ¦  52  ¦  5  ¦  52  ¦  7
2000-01-01  ¦  52  ¦  5  ¦  52  ¦  0

#SQL[@99,N38]Result[14, 2]
SELECT distinct extracted_week from t1;
extracted_week
52

#SQL[@100,N51]Error[107]
select date from t1 having extract(day FROM date)=1;
SQL syntax error: column \"t1.date\" must appear in the GROUP BY clause or be used in an aggregate function

#SQL[@101,N13]Result[]
drop table t1;

#SQL[@104,N51]Result[]
CREATE TABLE t1
(`date` date,
`extracted_week` int);

#SQL[@107,N67]Result[]
INSERT INTO t1 select '2000-01-01', EXTRACT(WEEK FROM '2000-01-01');

#SQL[@108,N16]Result[24, 18]
SELECT * FROM t1;
date  ¦  extracted_week
2000-01-01  ¦  52

#SQL[@109,N38]Result[14, 2]
SELECT distinct extracted_week from t1;
extracted_week
52

#SQL[@110,N51]Error[107]
select date from t1 having extract(day FROM date)=1;
SQL syntax error: column \"t1.date\" must appear in the GROUP BY clause or be used in an aggregate function

#SQL[@111,N13]Result[]
drop table t1;

