#SQL[@2,N22]Result[]
drop table if exists t;

#SQL[@3,N51]Result[]
CREATE TABLE t (i1 INT,
d1 DOUBLE,
e2 DECIMAL(5,2));

#SQL[@6,N111]Result[]
INSERT INTO t VALUES ( 6,    6.0,  10.0/3),
( null, 9.0,  10.0/3),
( 1,    null, 10.0/3),
( 2,    2.0,  null  );

#SQL[@10,N116]Result[31, 21, 24, 21, 21]
SELECT coalesce(e2,i1) nullif_c,
IF(e2 IS NULL,i1,e2) if_c,
SUM(d1) FROM t
GROUP BY e2,i1 ORDER BY nullif_c, SUM(d1);
nullif_c  ¦  if_c  ¦  SUM(d1)
2.00  ¦  2.00  ¦  2
3.33  ¦  3.33  ¦  null
3.33  ¦  3.33  ¦  6
3.33  ¦  3.33  ¦  9

#SQL[@14,N12]Result[]
DROP TABLE t;

#SQL[@17,N22]Result[]
CREATE TABLE t1(a INT);

#SQL[@18,N22]Result[]
CREATE TABLE t2(a INT);

#SQL[@19,N37]Result[]
INSERT INTO t1 VALUES (1),(2),(3),(4);

#SQL[@20,N29]Result[]
INSERT INTO t2 VALUES (1),(2);

#SQL[@21,N74]Error[49]
SELECT t1.a, t2.a FROM t1 JOIN t2
ON t1.a+t2.a = (SELECT COUNT(*) FROM t1);
subquery in JOIN condition is not yet implemented

#SQL[@23,N77]Result[3, 2, 2]
SELECT a + (SELECT SUM(a) + (SELECT COUNT(a) FROM t1) FROM t1) AS cnt
FROM t2;
cnt
15
16

#SQL[@25,N13]Result[]
drop table t1;

#SQL[@26,N13]Result[]
drop table t2;

#SQL[@29,N65]Result[]
CREATE TABLE t1 (name char(1) default NULL, val int default NULL);

#SQL[@30,N184]Result[]
INSERT INTO t1 VALUES ('a',1),  ('a',2),  ('a',2),  ('a',2),  ('a',3),  ('a',6), ('a',7), ('a',11), ('a',11), ('a',12), ('a',13), ('a',13), ('a',20), ('b',2), ('b',3), ('b',4), ('b',5);

#SQL[@31,N219]Error[57]
SELECT s.name, AVG(s.val) AS med FROM (SELECT x.name, x.val FROM t1 x, t1 y WHERE x.name=y.name GROUP BY x.name, x.val HAVING SUM(y.val <= x.val) >= COUNT(*)/2 AND SUM(y.val >= x.val) >= COUNT(*)/2) AS s GROUP BY s.name;
invalid argument aggregate function sum, bad value [BOOL]

#SQL[@32,N13]Result[]
drop table t1;

#SQL[@35,N38]Result[]
create table t1 (a integer, b integer);

#SQL[@36,N65]Result[]
insert into t1 values (1,4), (2,2),(2,2), (4,1),(4,1),(4,1),(4,1);

#SQL[@37,N32]Result[6, 1, 1, 1]
select sum(b) from t1 group by a;
sum(b)
4
4
4

#SQL[@38,N52]Result[6, 1, 1, 1]
select sum(b) from (select a,b from t1) y group by a;
sum(b)
4
4
4

#SQL[@39,N13]Result[]
drop table t1;

#SQL[@42,N50]Result[]
CREATE TABLE t1
(a INTEGER,
b INTEGER,
c INTEGER
);

#SQL[@47,N92]Result[]
INSERT INTO t1 VALUES
(1, 1, 10), (1, 2, 20), (1, 3, 30), (2, 1, 40), (2, 2, 50), (2, 3, 60);

#SQL[@49,N50]Result[]
CREATE TABLE t2
(a INTEGER,
d INTEGER,
e INTEGER
);

#SQL[@54,N56]Result[]
INSERT INTO t2 VALUES
(1, 6, 60), (2, 6, 60), (3, 6, 60);

#SQL[@56,N216]Result[59, 9, 9, 9, 9, 9]
WITH
cte AS
(SELECT SUM(c) AS c, SUM(b) AS b, a
FROM t1
GROUP BY a)
SELECT t2.a, (SELECT MIN(c) FROM cte AS cte2 WHERE t2.d = cte2.b)
FROM t2 LEFT JOIN cte AS cte1 ON t2.a = cte1.a
LEFT JOIN t2 AS tx ON tx.e = cte1.c;
a  ¦  (select MIN(c) from cte as cte2 where t2.d = cte2.b)
1  ¦  60
1  ¦  60
1  ¦  60
2  ¦  60
3  ¦  60

#SQL[@64,N13]Result[]
drop table t1;

#SQL[@65,N13]Result[]
drop table t2;

#SQL[@68,N35]Result[]
create table t1 (num  double(12,2));

#SQL[@69,N30]Result[]
insert into t1 values (144.54);

#SQL[@70,N44]Result[31, 6]
select sum(if(num is null,0.00,num)) from t1;
sum(if(num is null, 0.00, num))
144.54

#SQL[@71,N13]Result[]
drop table t1;

#SQL[@74,N51]Result[]
CREATE TABLE t1(c0 INTEGER, c1 INTEGER, c2 INTEGER);

#SQL[@75,N41]Result[]
INSERT INTO t1 VALUES(1, 1, 1), (1, 1, 1);

#SQL[@76,N74]Result[58, 1]
SELECT CASE AVG (c0) WHEN any_value(c1) * any_value(c2) THEN 1 END FROM t1;
case AVG(c0) when any_value(c1) * any_value(c2) then 1 end
1

#SQL[@77,N93]Result[78, 1]
SELECT CASE any_value(c1) * any_value(c2) WHEN SUM(c0) THEN 1 WHEN AVG(c0) THEN 2 END FROM t1;
case any_value(c1) * any_value(c2) when SUM(c0) then 1 when AVG(c0) then 2 end
2

#SQL[@78,N81]Result[70, 11]
SELECT CASE any_value(c1) WHEN any_value(c1) + 1 THEN 1 END, ABS(AVG(c0)) FROM t1;
case any_value(c1) when any_value(c1) + 1 then 1 end  ¦  ABS(AVG(c0))
null  ¦  1

#SQL[@79,N13]Result[]
DROP TABLE t1;

#SQL[@82,N79]Result[]
CREATE TABLE t1(a varchar(255), b INT, c INT UNSIGNED, d DECIMAL(12,2), e REAL);

#SQL[@83,N42]Result[]
INSERT INTO t1 VALUES('iynfj', 1, 1, 1, 1);

#SQL[@84,N42]Result[]
INSERT INTO t1 VALUES('innfj', 2, 2, 2, 2);

#SQL[@90,N67]Error[60]
SELECT  SUM(  a ) FROM t1 GROUP BY a HAVING a IN ( AVG( 1 ), 1 + a);
invalid argument aggregate function sum, bad value [VARCHAR]

#SQL[@91,N67]Result[6, 1]
SELECT  SUM(  b ) FROM t1 GROUP BY b HAVING b IN ( AVG( 1 ), 1 + b);
SUM(b)
1

#SQL[@92,N67]Result[6, 1]
SELECT  SUM(  c ) FROM t1 GROUP BY c HAVING c IN ( AVG( 1 ), 1 + c);
SUM(c)
1

#SQL[@93,N67]Result[6, 4]
SELECT  SUM(  d ) FROM t1 GROUP BY d HAVING d IN ( AVG( 1 ), 1 + d);
SUM(d)
1.00

#SQL[@94,N67]Result[6, 1]
SELECT  SUM(  e ) FROM t1 GROUP BY e HAVING e IN ( AVG( 1 ), 1 + e);
SUM(e)
1

#SQL[@95,N13]Result[]
DROP TABLE t1;

#SQL[@98,N16]Result[9, 4]
SELECT SUM(NULL);
SUM(null)
null

#SQL[@101,N20]Result[15, 4]
select sum(1)>sum(0);
sum(1) > sum(0)
true

#SQL[@104,N71]Result[]
create table t1(a bigint, b float, c double, d double, e varchar(1000));

#SQL[@107,N172]Result[]
insert into t1 select 21474836471, 12412490231412.124124124124, 124141231249124124.1241241243124123, 12421512141241241241241241849912840129402.1241124124241241, space(1000);

#SQL[@108,N172]Result[]
insert into t1 select 21474836471, 12412490231412.124124124124, 124141231249124124.1241241243124123, 12421512141241241241241241849912840129402.1241124124241241, space(1000);

#SQL[@109,N50]Error[60]
select sum(a), sum(b),sum(c),sum(d),sum(e) from t1;
invalid argument aggregate function sum, bad value [VARCHAR]

#SQL[@110,N43]Result[42, 102]
select sum(a), sum(b),sum(c),sum(d) from t1;
sum(a)  ¦  sum(b)  ¦  sum(c)  ¦  sum(d)
42949672942  ¦  24824980176896  ¦  248282462498248260  ¦  24843024282482480000000000000000000000000

#SQL[@111,N13]Result[]
drop table t1;

#SQL[@115,N46]Result[]
create table t1 (num float(5,2),user char(20));

#SQL[@116,N67]Result[]
insert into t1 values (10.3,'nem'),(20.53,'monty'),(30.23,'sinisa');

#SQL[@117,N68]Result[]
insert into t1 values (30.13,'nem'),(20.98,'monty'),(10.45,'sinisa');

#SQL[@118,N65]Result[]
insert into t1 values (5.2,'nem'),(8.64,'monty'),(11.12,'sinisa');

#SQL[@119,N23]Result[8, 18]
select sum(num) from t1;
sum(num)
147.57999897003174

#SQL[@120,N37]Result[8, 16, 17, 17]
select sum(num) from t1 group by user;
sum(num)
45.6299991607666
50.15000057220459
51.79999923706055

#SQL[@121,N13]Result[]
drop table t1;

#SQL[@124,N27]Result[]
create table t2 (ff double);

#SQL[@125,N27]Result[]
insert into t2 values (2.2);

#SQL[@126,N45]Result[30, 4]
select cast(sum( ff) as decimal(5,2)) from t2;
cast(sum(ff) as decimal(5, 2))
2.20

#SQL[@127,N39]Result[19, 1]
select cast(sum( ff) as signed) from t2;
cast(sum(ff) as ff)
2

#SQL[@128,N50]Result[36, 5]
select cast(variance(ff) as decimal(10,3)) from t2;
cast(variance(ff) as decimal(10, 3))
0.000

#SQL[@129,N44]Result[30, 4]
select cast(min(ff) as decimal(5,2)) from t2;
cast(min(ff) as decimal(5, 2))
2.20

#SQL[@130,N33]Result[]
create table t1 (df decimal(5,1));

#SQL[@131,N26]Result[]
insert into t1 values(1.1);

#SQL[@132,N26]Result[]
insert into t1 values(2.2);

#SQL[@134,N39]Result[19, 1]
select cast(sum( df) as signed) from t1;
cast(sum(df) as df)
3

#SQL[@135,N38]Result[19, 1]
select cast(min(df) as signed) from t1;
cast(min(df) as df)
1

#SQL[@136,N29]Result[13, 9]
select 1e8 * sum( df) from t1;
1e8 * sum(df)
330000000

#SQL[@137,N28]Result[13, 18]
select 1e8 * min(df) from t1;
1e8 * min(df)
110000000.00000001

#SQL[@139,N25]Result[]
create table t3 (ifl int);

#SQL[@140,N29]Result[]
insert into t3 values(1), (2);

#SQL[@141,N45]Result[31, 4]
select cast(min(ifl) as decimal(5,2)) from t3;
cast(min(ifl) as decimal(5, 2))
1.00

#SQL[@142,N13]Result[]
drop table t1;

#SQL[@143,N13]Result[]
drop table t2;

#SQL[@144,N13]Result[]
drop table t3;

#SQL[@146,N65]Result[]
create table t1 (grp int, a bigint unsigned, c char(10) not null);

#SQL[@147,N31]Result[]
insert into t1 values (1,1,"a");

#SQL[@148,N31]Result[]
insert into t1 values (2,2,"b");

#SQL[@149,N31]Result[]
insert into t1 values (2,3,"c");

#SQL[@150,N31]Result[]
insert into t1 values (3,4,"E");

#SQL[@151,N31]Result[]
insert into t1 values (3,5,"C");

#SQL[@152,N31]Result[]
insert into t1 values (3,6,"D");

#SQL[@153,N48]Result[38, 9]
select sum(distinct a),sum(distinct grp) from t1;
sum(distinct a)  ¦  sum(distinct grp)
21  ¦  6

#SQL[@154,N36]Result[]
insert into t1 values (null,null,'');

#SQL[@155,N48]Result[38, 9]
select sum(distinct a),sum(distinct grp) from t1;
sum(distinct a)  ¦  sum(distinct grp)
21  ¦  6

#SQL[@156,N13]Result[]
drop table t1;

