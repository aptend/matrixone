#SQL[@3,N23]Result[]
drop table if exists t1;

#SQL[@4,N49]Result[]
create table t1(
a varchar(100),
b varchar(100)
);

#SQL[@9,N37]Result[]
insert into t1 values('dddd', 'cccc');

#SQL[@10,N37]Result[]
insert into t1 values('aaaa', 'bbbb');

#SQL[@11,N37]Result[]
insert into t1 values('eeee', 'aaaa');

#SQL[@12,N24]Result[]
insert into t1 values ();

#SQL[@13,N16]Result[8, 14, 14, 14, 14]
select * from t1;
a  ¦  b
dddd  ¦  cccc
aaaa  ¦  bbbb
eeee  ¦  aaaa
null  ¦  null

#SQL[@15,N43]Result[1, 4, 4]
(select a from t1) minus (select b from t1);
a
dddd
eeee

#SQL[@16,N51]Result[1, 4, 4, 4]
(select a from t1) minus (select a from t1 limit 1);
a
aaaa
eeee
null

#SQL[@17,N51]Result[1, 4, 4]
(select a from t1) minus (select a from t1 limit 2);
a
eeee
null

#SQL[@18,N51]Result[1, 4]
(select a from t1) minus (select a from t1 limit 3);
a
null

#SQL[@19,N51]Result[]
(select a from t1) minus (select a from t1 limit 4);

#SQL[@21,N43]Result[1, 4, 4]
(select b from t1) minus (select a from t1);
b
cccc
bbbb

#SQL[@22,N51]Result[1, 4, 4, 4]
(select b from t1) minus (select b from t1 limit 1);
b
bbbb
aaaa
null

#SQL[@23,N51]Result[1, 4, 4]
(select b from t1) minus (select b from t1 limit 2);
b
aaaa
null

#SQL[@24,N51]Result[1, 4]
(select b from t1) minus (select b from t1 limit 3);
b
null

#SQL[@25,N51]Result[]
(select b from t1) minus (select b from t1 limit 4);

#SQL[@27,N68]Result[1, 4, 4]
(select a from t1) minus (select b from t1) minus (select b from t1);
a
dddd
eeee

#SQL[@28,N93]Result[]
(select a from t1) minus (select b from t1) minus (select b from t1) minus (select a from t1);

#SQL[@30,N70]Result[1, 4, 4]
((select a from t1) union (select b from t1)) minus (select a from t1);
a
cccc
bbbb

#SQL[@32,N13]Result[]
drop table t1;

#SQL[@35,N23]Result[]
drop table if exists t2;

#SQL[@36,N59]Result[]
create table t2(
col1 date,
col2 datetime,
col3 timestamp
);

#SQL[@42,N24]Result[]
insert into t2 values ();

#SQL[@43,N63]Result[]
insert into t2 values('2022-01-01', '2022-01-01', '2022-01-01');

#SQL[@44,N88]Result[]
insert into t2 values('2022-01-01', '2022-01-01 00:00:00', '2022-01-01 00:00:00.000000');

#SQL[@45,N95]Result[]
insert into t2 values('2022-01-01', '2022-01-01 00:00:00.000000', '2022-01-01 23:59:59.999999');

#SQL[@46,N16]Result[24, 24, 60, 60, 60]
select * from t2;
col1  ¦  col2  ¦  col3
null  ¦  null  ¦  null
2022-01-01  ¦  2022-01-01 00:00:00  ¦  2022-01-01 00:00:00
2022-01-01  ¦  2022-01-01 00:00:00  ¦  2022-01-01 00:00:00
2022-01-01  ¦  2022-01-01 00:00:00  ¦  2022-01-02 00:00:00

#SQL[@49,N57]Result[4, 10]
(select col1 from t2) minus (select col1 from t2 limit 1);
col1
2022-01-01

#SQL[@50,N49]Result[]
(select col1 from t2) minus (select col2 from t2);

#SQL[@51,N49]Result[]
(select col1 from t2) minus (select col3 from t2);

#SQL[@53,N57]Result[4, 4, 10]
(select col1 from t2) minus (select col1 from t2 limit 0);
col1
null
2022-01-01

#SQL[@54,N57]Result[4, 4, 19]
(select col1 from t2) minus (select col2 from t2 limit 0);
col1
null
2022-01-01 00:00:00

#SQL[@55,N57]Result[4, 4, 19]
(select col1 from t2) minus (select col3 from t2 limit 0);
col1
null
2022-01-01 00:00:00

#SQL[@57,N57]Result[4, 4, 19]
(select col2 from t2) minus (select col1 from t2 limit 0);
col2
null
2022-01-01 00:00:00

#SQL[@58,N57]Result[4, 4, 19]
(select col2 from t2) minus (select col2 from t2 limit 0);
col2
null
2022-01-01 00:00:00

#SQL[@59,N57]Result[4, 4, 19]
(select col2 from t2) minus (select col3 from t2 limit 0);
col2
null
2022-01-01 00:00:00

#SQL[@61,N57]Result[4, 4, 19, 19]
(select col3 from t2) minus (select col1 from t2 limit 0);
col3
null
2022-01-01 00:00:00
2022-01-02 00:00:00

#SQL[@62,N57]Result[4, 4, 19, 19]
(select col3 from t2) minus (select col2 from t2 limit 0);
col3
null
2022-01-01 00:00:00
2022-01-02 00:00:00

#SQL[@63,N57]Result[4, 4, 19, 19]
(select col3 from t2) minus (select col3 from t2 limit 0);
col3
null
2022-01-01 00:00:00
2022-01-02 00:00:00

#SQL[@65,N13]Result[]
drop table t2;

#SQL[@69,N23]Result[]
drop table if exists t3;

#SQL[@70,N24]Result[]
create table t3(
a int
);

#SQL[@74,N42]Result[]
insert into t3 values (20),(10),(30),(-10);

#SQL[@76,N23]Result[]
drop table if exists t4;

#SQL[@77,N48]Result[]
create table t4(
col1 float,
col2 decimal(5,2)
);

#SQL[@82,N36]Result[]
insert into t4 values(100.01,100.01);

#SQL[@83,N32]Result[]
insert into t4 values(1.10,1.10);

#SQL[@84,N30]Result[]
insert into t4 values(0.0,0.0);

#SQL[@85,N34]Result[]
insert into t4 values(127.0,127.0);

#SQL[@86,N36]Result[]
insert into t4 values(127.44,127.44);

#SQL[@89,N74]Result[1, 2, 2, 2, 3]
(select a from t3) union (select col1 from t4) minus (select col1 from t4);
a
20
10
30
-10

#SQL[@90,N74]Result[1, 5, 5, 5, 6]
(select a from t3) union (select col2 from t4) minus (select col2 from t4);
a
20.00
10.00
30.00
-10.00

#SQL[@91,N71]Result[1, 18, 17, 1, 3, 18]
(select a from t3) union (select col1 from t4) minus (select a from t3);
a
100.01000213623047
1.100000023841858
0
127
127.44000244140625

#SQL[@92,N71]Result[1, 6, 4, 4, 6, 6]
(select a from t3) union (select col2 from t4) minus (select a from t3);
a
100.01
1.10
0.00
127.00
127.44

#SQL[@94,N49]Result[]
(select col1 from t4) minus (select col1 from t4);

#SQL[@95,N49]Result[4, 18, 17, 18]
(select col1 from t4) minus (select col2 from t4);
col1
100.01000213623047
1.100000023841858
127.44000244140625

#SQL[@96,N49]Result[]
(select col2 from t4) minus (select col2 from t4);

#SQL[@97,N49]Result[4, 6, 3, 6]
(select col2 from t4) minus (select col1 from t4);
col2
100.01
1.1
127.44

#SQL[@99,N13]Result[]
drop table t3;

#SQL[@100,N13]Result[]
drop table t4;

#SQL[@103,N23]Result[]
drop table if exists t5;

#SQL[@104,N32]Result[]
create table t5(
a int,
b text
);

#SQL[@109,N32]Result[]
insert into t5 values (11, 'aa');

#SQL[@110,N32]Result[]
insert into t5 values (33, 'bb');

#SQL[@111,N32]Result[]
insert into t5 values (44, 'aa');

#SQL[@112,N32]Result[]
insert into t5 values (55, 'cc');

#SQL[@113,N32]Result[]
insert into t5 values (55, 'dd');

#SQL[@115,N23]Result[]
drop table if exists t6;

#SQL[@116,N64]Result[]
create table t6 (
col1 varchar(100),
col2 text,
col3 char(100)
);

#SQL[@122,N40]Result[]
insert into t6 values ('aa', '11', 'aa');

#SQL[@123,N40]Result[]
insert into t6 values ('bb', '22', '11');

#SQL[@124,N40]Result[]
insert into t6 values ('cc', '33', 'bb');

#SQL[@125,N40]Result[]
insert into t6 values ('dd', '44', '22');

#SQL[@127,N46]Result[1, 2]
(select a from t5) minus (select col2 from t6);
a
55

#SQL[@128,N46]Result[4, 2]
(select col2 from t6) minus (select a from t5);
col2
22

#SQL[@130,N46]Result[]
(select b from t5) minus (select col1 from t6);

#SQL[@131,N46]Result[1, 2, 2, 2, 2]
(select b from t5) minus (select col2 from t6);
b
aa
bb
cc
dd

#SQL[@132,N46]Result[1, 2, 2]
(select b from t5) minus (select col3 from t6);
b
cc
dd

#SQL[@134,N46]Result[]
(select col1 from t6) minus (select b from t5);

#SQL[@135,N46]Result[4, 2, 2, 2, 2]
(select col2 from t6) minus (select b from t5);
col2
11
22
33
44

#SQL[@136,N46]Result[4, 2, 2]
(select col3 from t6) minus (select b from t5);
col3
11
22

#SQL[@138,N13]Result[]
drop table t5;

#SQL[@139,N13]Result[]
drop table t6;

#SQL[@142,N23]Result[]
drop table if exists t7;

#SQL[@143,N56]Result[]
CREATE TABLE t7 (
a int not null,
b char (10) not null
);

#SQL[@148,N52]Result[]
insert into t7 values(1,'3'),(2,'4'),(3,'5'),(3,'1');

#SQL[@150,N57]Result[]
select * from (select a from t7 minus select a from t7) a;

#SQL[@152,N57]Result[1, 1]
select * from (select a from t7 minus select b from t7) a;
a
2

#SQL[@153,N57]Result[1, 1, 1]
select * from (select b from t7 minus select a from t7) a;
b
4
5

#SQL[@155,N67]Result[1, 1, 1]
select * from (select a from t7 minus (select b from t7 limit 2)) a;
a
1
2

#SQL[@156,N67]Result[1, 1, 1, 1]
select * from (select b from t7 minus (select a from t7 limit 2)) a;
b
3
4
5

#SQL[@158,N65]Result[1, 1]
select * from (select a from t7 minus select b from t7 limit 1) a;
a
2

#SQL[@159,N65]Result[1, 1]
select * from (select b from t7 minus select a from t7 limit 1) a;
b
4

#SQL[@161,N69]Result[1, 1, 1]
select * from (select a from t7 minus select b from t7 where a > 2) a;
a
2
3

#SQL[@162,N69]Result[1, 1, 1, 1, 1]
select * from (select b from t7 minus select a from t7 where a > 4) a;
b
3
4
5
1

#SQL[@164,N13]Result[]
drop table t7;

#SQL[@167,N23]Result[]
drop table if exists t8;

#SQL[@168,N44]Result[]
create table t8 (
a int primary key,
b int
);

#SQL[@173,N39]Result[]
insert into t8 values (1,5),(2,4),(3,3);

#SQL[@174,N8]Result[]
set @a=1;

#SQL[@176,N81]Result[]
prepare s1 from '(select a from t8 where a>?) minus (select b from t8 where b>?)';

#SQL[@177,N46]Result[]
prepare s2 from '(select a from t8 where a>?)';

#SQL[@179,N19]Error[45]
execute s1 using @a;
invalid input: Incorrect arguments to EXECUTE

#SQL[@180,N23]Result[1, 1]
execute s1 using @a, @a;
a
2

#SQL[@181,N19]Result[1, 1, 1]
execute s2 using @a;
a
2
3

#SQL[@182,N23]Error[45]
execute s2 using @a, @a;
invalid input: Incorrect arguments to EXECUTE

#SQL[@184,N21]Result[]
deallocate prepare s1;

#SQL[@185,N21]Result[]
deallocate prepare s2;

#SQL[@187,N13]Result[]
drop table t8;

#SQL[@190,N23]Result[]
drop table if exists t9;

#SQL[@191,N35]Result[]
create table t9(
a int,
b varchar
);

#SQL[@196,N59]Result[]
insert into t9 values (1, 'a'), (2, 'b'), (3,'c'), (4, 'd');

#SQL[@198,N24]Result[]
drop table if exists t10;

#SQL[@199,N36]Result[]
create table t10(
c int,
d varchar
);

#SQL[@204,N61]Result[]
insert into t10 values (1, 'a'), (10, 'b'), (2,'b'), (2, 'e');

#SQL[@206,N90]Result[1, 1, 1]
(select a from t9) minus (select tab1.a from t9 as tab1 join t10 as tab2 on tab1.a=tab2.c);
a
3
4

#SQL[@207,N95]Result[]
(select a from t9) minus (select tab1.a from t9 as tab1 left join t10 as tab2 on tab1.a=tab2.c);

#SQL[@208,N96]Result[1, 1, 1]
(select a from t9) minus (select tab1.a from t9 as tab1 right join t10 as tab2 on tab1.a=tab2.c);
a
3
4

#SQL[@210,N90]Result[1, 1, 1]
(select b from t9) minus (select tab1.b from t9 as tab1 join t10 as tab2 on tab1.b=tab2.d);
b
c
d

#SQL[@211,N95]Result[]
(select b from t9) minus (select tab1.b from t9 as tab1 left join t10 as tab2 on tab1.b=tab2.d);

#SQL[@212,N96]Result[1, 1, 1]
(select b from t9) minus (select tab1.b from t9 as tab1 right join t10 as tab2 on tab1.b=tab2.d);
b
c
d

#SQL[@214,N91]Result[1, 2]
(select c from t10) minus (select tab1.a from t9 as tab1 join t10 as tab2 on tab1.a=tab2.c);
c
10

#SQL[@215,N96]Result[1, 2]
(select c from t10) minus (select tab1.a from t9 as tab1 left join t10 as tab2 on tab1.a=tab2.c);
c
10

#SQL[@216,N97]Result[1, 2]
(select c from t10) minus (select tab1.a from t9 as tab1 right join t10 as tab2 on tab1.a=tab2.c);
c
10

#SQL[@218,N91]Result[1, 1]
(select d from t10) minus (select tab1.b from t9 as tab1 join t10 as tab2 on tab1.b=tab2.d);
d
e

#SQL[@219,N96]Result[1, 1]
(select d from t10) minus (select tab1.b from t9 as tab1 left join t10 as tab2 on tab1.b=tab2.d);
d
e

#SQL[@220,N97]Result[1, 1]
(select d from t10) minus (select tab1.b from t9 as tab1 right join t10 as tab2 on tab1.b=tab2.d);
d
e

#SQL[@222,N13]Result[]
drop table t9;

#SQL[@223,N14]Result[]
drop table t10;

#SQL[@226,N24]Result[]
drop table if exists t11;

#SQL[@227,N169]Result[]
create table t11 (
RID int(11) not null default '0',
IID int(11) not null default '0',
nada varchar(50)  not null,
NAME varchar(50) not null,
PHONE varchar(50) not null);

#SQL[@234,N329]Result[]
insert into t11 ( RID,IID,nada,NAME,PHONE) values
(1, 1, 'main', 'a', '111'),
(2, 1, 'main', 'b', '222'),
(3, 1, 'main', 'c', '333'),
(4, 1, 'main', 'd', '444'),
(5, 1, 'main', 'e', '555'),
(6, 2, 'main', 'c', '333'),
(7, 2, 'main', 'd', '454'),
(8, 2, 'main', 'e', '555'),
(9, 2, 'main', 'f', '666'),
(10, 2, 'main', 'g', '777');

#SQL[@246,N323]Result[36, 30, 30]
select A.NAME, A.PHONE, B.NAME, B.PHONE from t11 A
left join t11 B on A.NAME = B.NAME and B.IID = 2 where A.IID = 1 and (A.PHONE <> B.PHONE or B.NAME is null)
minus
select A.NAME, A.PHONE, B.NAME, B.PHONE from t11 B left join t11 A on B.NAME = A.NAME and A.IID = 1
where B.IID = 2 and (A.PHONE <> B.PHONE or A.NAME is null);
NAME  ¦  PHONE  ¦  NAME  ¦  PHONE
a  ¦  111  ¦  null  ¦  null
b  ¦  222  ¦  null  ¦  null

#SQL[@252,N323]Result[36, 30, 30]
select A.NAME, A.PHONE, B.NAME, B.PHONE from t11 B left join t11 A on B.NAME = A.NAME and A.IID = 1
where B.IID = 2 and (A.PHONE <> B.PHONE or A.NAME is null)
minus
select A.NAME, A.PHONE, B.NAME, B.PHONE from t11 A
left join t11 B on A.NAME = B.NAME and B.IID = 2 where A.IID = 1 and (A.PHONE <> B.PHONE or B.NAME is null);
NAME  ¦  PHONE  ¦  NAME  ¦  PHONE
null  ¦  null  ¦  f  ¦  666
null  ¦  null  ¦  g  ¦  777

#SQL[@258,N11]Result[]
set @val1=1;

#SQL[@259,N11]Result[]
set @val2=2;

#SQL[@261,N341]Result[]
prepare s1 from
'select A.NAME, A.PHONE, B.NAME, B.PHONE from t11 A
left join t11 B on A.NAME = B.NAME and B.IID = ? where A.IID = ? and (A.PHONE <> B.PHONE or B.NAME is null)
minus
select A.NAME, A.PHONE, B.NAME, B.PHONE from t11 B left join t11 A on B.NAME = A.NAME and A.IID = ?
where B.IID = ? and (A.PHONE <> B.PHONE or A.NAME is null)';

#SQL[@268,N43]Result[36, 30, 30]
execute s1 using @val2, @val1, @val1, @val2;
NAME  ¦  PHONE  ¦  NAME  ¦  PHONE
a  ¦  111  ¦  null  ¦  null
b  ¦  222  ¦  null  ¦  null

#SQL[@270,N21]Result[]
deallocate prepare s1;

#SQL[@272,N14]Result[]
drop table t11;

#SQL[@275,N24]Result[]
drop table if exists t12;

#SQL[@277,N59]Result[]
create table t12(
a int primary key,
b int auto_increment
);

#SQL[@282,N29]Result[]
insert into t12(a) values (1);

#SQL[@283,N29]Result[]
insert into t12(a) values (2);

#SQL[@284,N29]Result[]
insert into t12(a) values (3);

#SQL[@285,N30]Result[]
insert into t12(a) values (10);

#SQL[@286,N30]Result[]
insert into t12(a) values (20);

#SQL[@288,N46]Result[1, 2, 2]
(select a from t12 ) minus (select b from t12);
a
10
20

#SQL[@289,N46]Result[]
(select a from t12 ) minus (select a from t12);

#SQL[@291,N46]Result[1, 1, 1]
(select b from t12 ) minus (select a from t12);
b
4
5

#SQL[@292,N46]Result[]
(select b from t12 ) minus (select b from t12);

#SQL[@294,N14]Result[]
drop table t12;

#SQL[@296,N23]Result[]
drop table if exists t2;

#SQL[@297,N59]Result[]
create table t2(
col1 date,
col2 datetime,
col3 timestamp
);

#SQL[@303,N24]Result[]
insert into t2 values ();

#SQL[@304,N63]Result[]
insert into t2 values('2022-01-01', '2022-01-01', '2022-01-01');

#SQL[@305,N94]Result[]
insert into t2 values('2022-01-01', '2022-01-01 00:00:00.99999', '2022-01-01 00:00:00.000000');

#SQL[@306,N95]Result[]
insert into t2 values('2022-01-01', '2022-01-01 00:00:00.999999', '2022-01-01 23:59:59.999999');

#SQL[@307,N16]Result[24, 24, 60, 60, 60]
select * from t2;
col1  ¦  col2  ¦  col3
null  ¦  null  ¦  null
2022-01-01  ¦  2022-01-01 00:00:00  ¦  2022-01-01 00:00:00
2022-01-01  ¦  2022-01-01 00:00:01  ¦  2022-01-01 00:00:00
2022-01-01  ¦  2022-01-01 00:00:01  ¦  2022-01-02 00:00:00

#SQL[@309,N57]Result[4, 4, 19]
(select col1 from t2) minus (select col2 from t2 limit 0);
col1
null
2022-01-01 00:00:00

#SQL[@310,N57]Result[4, 4, 19]
(select col1 from t2) minus (select col3 from t2 limit 0);
col1
null
2022-01-01 00:00:00

#SQL[@312,N57]Result[4, 4, 19, 19]
(select col2 from t2) minus (select col1 from t2 limit 0);
col2
null
2022-01-01 00:00:00
2022-01-01 00:00:01

#SQL[@313,N57]Result[4, 4, 19, 19]
(select col2 from t2) minus (select col3 from t2 limit 0);
col2
null
2022-01-01 00:00:00
2022-01-01 00:00:01

#SQL[@315,N57]Result[4, 4, 19, 19]
(select col3 from t2) minus (select col1 from t2 limit 0);
col3
null
2022-01-01 00:00:00
2022-01-02 00:00:00

#SQL[@316,N57]Result[4, 4, 19, 19]
(select col3 from t2) minus (select col2 from t2 limit 0);
col3
null
2022-01-01 00:00:00
2022-01-02 00:00:00

#SQL[@318,N13]Result[]
drop table t2;

