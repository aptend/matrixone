#SQL[@6,N51]Result[38, 1]
select CASE "b" when "a" then 1 when "b" then 2 END;
case b when a then 1 when b then 2 end
2

#SQL[@7,N51]Result[38, 4]
select CASE "c" when "a" then 1 when "b" then 2 END;
case c when a then 1 when b then 2 end
null

#SQL[@8,N58]Result[45, 1]
select CASE "c" when "a" then 1 when "b" then 2 ELSE 3 END;
case c when a then 1 when b then 2 else 3 end
3

#SQL[@9,N49]Result[40, 5]
select CASE when 1=0 then "true" else "false" END;
case when 1 = 0 then true else false end
false

#SQL[@10,N65]Result[52, 3]
select CASE 1 when 1 then "one" WHEN 2 then "two" ELSE "more" END;
case 1 when 1 then one when 2 then two else more end
one

#SQL[@11,N69]Result[56, 3]
select CASE 2.0 when 1 then "one" WHEN 2.0 then "two" ELSE "more" END;
case 2.0 when 1 then one when 2.0 then two else more end
two

#SQL[@13,N67]Result[50, 1]
select (CASE "two" when "one" then "1" WHEN "two" then "2" END) | 0;
(case two when one then 1 when two then 2 end) | 0
2

#SQL[@15,N70]Result[58, 4]
select (CASE "two" when "one" then 1.00 WHEN "two" then 2.00 END) +0.0;
(case two when one then 1.00 when two then 2.00 end) + 0.0
2.00

#SQL[@16,N53]Error[16]
select case 1/0 when "a" then "true" else "false" END;
division by zero

#SQL[@17,N40]Error[16]
select case 1/0 when "a" then "true" END;
division by zero

#SQL[@19,N46]Error[16]
select (case 1/0 when "a" then "true" END) | 0;
division by zero

#SQL[@21,N48]Error[16]
select (case 1/0 when "a" then "true" END) + 0.0;
division by zero

#SQL[@22,N49]Result[40, 4]
select case when 1>0 then "TRUE" else "FALSE" END;
case when 1 > 0 then TRUE else FALSE end
TRUE

#SQL[@23,N49]Result[40, 5]
select case when 1<0 then "TRUE" else "FALSE" END;
case when 1 < 0 then TRUE else FALSE end
FALSE

#SQL[@24,N54]Result[45, 4]
SELECT CAST(CASE WHEN 0 THEN '2001-01-01' END AS DATE);
cast(case when 0 then 2001-01-01 end as date)
null

#SQL[@25,N58]Result[51, 4]
SELECT CAST(CASE WHEN 0 THEN DATE'2001-01-01' END AS DATE);
cast(case when 0 then DATE(2001-01-01) end as date)
null

#SQL[@26,N64]Result[51, 1]
select case 1.0 when 0.1 then "a" when 1.0 then "b" else "c" END;
case 1.0 when 0.1 then a when 1.0 then b else c end
b

#SQL[@27,N64]Result[51, 1]
select case 0.1 when 0.1 then "a" when 1.0 then "b" else "c" END;
case 0.1 when 0.1 then a when 1.0 then b else c end
a

#SQL[@28,N62]Result[49, 1]
select case 1 when 0.1 then "a" when 1.0 then "b" else "c" END;
case 1 when 0.1 then a when 1.0 then b else c end
b

#SQL[@29,N62]Result[49, 1]
select case 1.0 when 0.1 then "a" when 1 then "b" else "c" END;
case 1.0 when 0.1 then a when 1 then b else c end
b

#SQL[@30,N64]Result[51, 1]
select case 1.001 when 0.1 then "a" when 1 then "b" else "c" END;
case 1.001 when 0.1 then a when 1 then b else c end
c

#SQL[@35,N23]Result[]
drop table if exists t1;

#SQL[@36,N23]Result[]
drop table if exists t2;

#SQL[@37,N48]Result[]
CREATE TABLE t1 (a varchar(10), PRIMARY KEY (a));

#SQL[@38,N55]Result[]
CREATE TABLE t2 (a varchar(10), b date, PRIMARY KEY(a));

#SQL[@39,N31]Result[]
INSERT INTO t1 VALUES ('test1');

#SQL[@40,N90]Result[]
INSERT INTO t2 VALUES
('test1','2016-12-13'),('test2','2016-12-14'),('test3','2016-12-15');

#SQL[@51,N23]Result[]
drop table if exists t1;

#SQL[@52,N23]Result[]
create table t1 (a int);

#SQL[@53,N36]Result[]
insert into t1 values(1),(2),(3),(4);

#SQL[@54,N94]Result[19, 8, 8, 8]
select case a when 1 then 2 when 2 then 3 else 0 end as fcase, count(*) from t1 group by fcase;
fcase  ¦  count(*)
2  ¦  1
3  ¦  1
0  ¦  2

#SQL[@55,N110]Result[19, 10, 10, 14]
select case a when 1 then "one" when 2 then "two" else "nothing" end as fcase, count(*) from t1 group by fcase;
fcase  ¦  count(*)
one  ¦  1
two  ¦  1
nothing  ¦  2

#SQL[@56,N23]Result[]
drop table if exists t1;

#SQL[@61,N81]Result[]
create table t1 (`row` int not null, col int not null, val varchar(255) not null);

#SQL[@62,N108]Result[]
insert into t1 values (1,1,'orange'),(1,2,'large'),(2,1,'yellow'),(2,2,'medium'),(3,1,'green'),(3,2,'small');

#SQL[@63,N96]Result[89, 20, 19, 20, 20, 19, 19]
select col,val, case when val="orange" then 1 when upper(val)="LARGE" then 2  else 3 end from t1;
col  ¦  val  ¦  case when val = orange then 1 when upper(val) = LARGE then 2 else 3 end
1  ¦  orange  ¦  1
2  ¦  large  ¦  2
1  ¦  yellow  ¦  3
2  ¦  medium  ¦  3
1  ¦  green  ¦  3
2  ¦  small  ¦  3

#SQL[@64,N82]Result[5, 6, 6, 5]
select max(case col when 1 then val else null end) as color from t1 group by `row`;
color
orange
yellow
green

#SQL[@65,N23]Result[]
drop table if exists t1;

#SQL[@67,N41]Result[]
create table t1(a float, b int default 3);

#SQL[@68,N40]Result[]
insert into t1 (a) values (2), (11), (8);

#SQL[@69,N127]Result[101, 15]
select min(a), min(case when 1=1 then a else NULL end),
  min(case when 1!=1 then NULL else a end)
from t1 where b=3 group by b;
min(a)  ¦  min(case when 1 = 1 then a else null end)  ¦  min(case when 1 != 1 then null else a end)
2  ¦  2  ¦  2

#SQL[@73,N24]Result[]
drop table if exists  t1;

#SQL[@74,N30]Result[]
CREATE TABLE t1 (a INT, b INT);

#SQL[@75,N57]Result[]
INSERT INTO t1 VALUES (1,1),(2,1),(3,2),(4,2),(5,3),(6,3);

#SQL[@76,N81]Result[53, 8, 8, 8]
SELECT CASE WHEN AVG(a)>=0 THEN 'Positive' ELSE 'Negative' END FROM t1 GROUP BY b;
case when AVG(a) >= 0 then Positive else Negative end
Positive
Positive
Positive

#SQL[@78,N24]Result[]
drop table if exists  t1;

#SQL[@83,N24]Result[]
drop table if exists  t1;

#SQL[@84,N24]Result[]
drop table if exists  t2;

#SQL[@85,N42]Result[]
create table t1 (a int, b bigint unsigned);

#SQL[@86,N23]Result[]
create table t2 (c int);

#SQL[@87,N106]Result[]
insert into t1 (a, b) values (1,4572794622775114594), (2,18196094287899841997),
  (3,11120436154190595086);

#SQL[@89,N39]Result[]
insert into t2 (c) values (1), (2), (3);

#SQL[@90,N96]Error[64]
select t1.a, (case t1.a when 0 then 0 else t1.b end) d from t1
  join t2 on t1.a=t2.c order by d;
data out of range: data type int64, value '18196094287899841997'

#SQL[@92,N125]Error[64]
select t1.a, (case t1.a when 0 then 0 else t1.b end) d from t1
  join t2 on t1.a=t2.c where b=11120436154190595086 order by d;
data out of range: data type int64, value '11120436154190595086'

#SQL[@94,N26]Result[]
drop table if exists small;

#SQL[@95,N24]Result[]
drop table if exists big;

#SQL[@96,N53]Result[]
CREATE TABLE small (id int not null,PRIMARY KEY (id));

#SQL[@97,N51]Result[]
CREATE TABLE big (id int not null,PRIMARY KEY (id));

#SQL[@98,N33]Result[]
INSERT INTO small VALUES (1), (2);

#SQL[@99,N41]Result[]
INSERT INTO big VALUES (1), (2), (3), (4);

#SQL[@100,N262]Result[35, 22, 22, 31, 31]
SELECT big.*, dt.* FROM big LEFT JOIN (SELECT id as dt_id,
                           CASE id WHEN 0 THEN 0 ELSE 1 END AS simple,
                           CASE WHEN id=0 THEN NULL ELSE 1 END AS cond
                    FROM small) AS dt
     ON big.id=dt.dt_id;
id  ¦  dt_id  ¦  simple  ¦  cond
1  ¦  1  ¦  1  ¦  1
2  ¦  2  ¦  1  ¦  1
3  ¦  null  ¦  null  ¦  null
4  ¦  null  ¦  null  ¦  null

#SQL[@106,N26]Result[]
drop table if exists small;

#SQL[@107,N24]Result[]
drop table if exists big;

#SQL[@112,N83]Result[15, 5, 15]
SELECT 'case+union+test'
UNION
SELECT CASE '1' WHEN '2' THEN 'BUG' ELSE 'nobug' END;
case+union+test
nobug
case+union+test

#SQL[@119,N13]Result[]
drop table t1;

#SQL[@120,N22]Result[]
CREATE TABLE t1(a int);

#SQL[@121,N48]Result[]
insert into t1 values(1),(1),(2),(1),(3),(2),(1);

#SQL[@122,N62]Result[1, 1, 1, 1, 1]
SELECT 1 FROM t1 WHERE a=1 AND CASE 1 WHEN a THEN 1 ELSE 1 END;
1
1
1
1
1

#SQL[@123,N23]Result[]
DROP TABLE if exists t1;

#SQL[@128,N23]Result[]
DROP TABLE if exists t1;

#SQL[@129,N59]Result[]
create table t1 (USR_ID int not null, MAX_REQ int not null);

#SQL[@130,N28]Result[]
insert into t1 values (1, 3);

#SQL[@131,N140]Result[108, 1]
select count(*) + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ from t1 group by MAX_REQ;
count(*) + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ
1

#SQL[@132,N98]Result[46, 1]
select Case When Count(*) < MAX_REQ Then 1 Else 0 End from t1 where t1.USR_ID = 1 group by MAX_REQ;
case when Count(*) < MAX_REQ then 1 else 0 end
1

#SQL[@133,N23]Result[]
DROP TABLE if exists t1;

#SQL[@135,N62]Result[55, 4]
select case when 1 in (1.0, 2.0, 3.0) then true else false end;
case when 1 in (1.0, 2.0, 3.0) then true else false end
true

#SQL[@137,N23]Result[]
DROP TABLE if exists t1;

#SQL[@138,N249]Result[]
CREATE TABLE t1 (
                    id int NOT NULL AUTO_INCREMENT,
                    key_num int NOT NULL DEFAULT '0',
                    hiredate date NOT NULL,
                    PRIMARY KEY (id),
                    KEY key_num (key_num)
);

#SQL[@146,N911]Result[]
insert into t1 values
                   (1, 7369, '1980-12-17'),
                   (2, 7499, '1981-02-20'),
                   (3, 7521, '1981-02-22'),
                   (4, 7566, '1981-04-02'),
                   (5, 7654, '1981-09-28'),
                   (6, 7698, '1981-05-01'),
                   (7, 7782, '1981-06-09'),
                   (8, 7788, '0087-07-13'),
                   (9, 7839, '1981-11-17'),
                   (10, 7844, '1981-09-08'),
                   (11, 7876, '2007-07-13'),
                   (12, 7900, '1981-12-03'),
                   (13, 7980, '1987-07-13'),
                   (14, 7981, '2001-11-17'),
                   (15, 7982, '1951-11-08'),
                   (16, 7983, '1927-10-13'),
                   (17, 7984, '1671-12-09'),
                   (18, 7985, '1981-11-06'),
                   (19, 7986, '1771-12-06'),
                   (20, 7987, '1985-10-06');

#SQL[@167,N118]Result[11, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9]
select id, case when id < 5 then 0 when id < 10 then 1 when id < 15 then 2 when true then 3 else -1 end as xxx from t1;
id  ¦  xxx
1  ¦  0
2  ¦  0
3  ¦  0
4  ¦  0
5  ¦  1
6  ¦  1
7  ¦  1
8  ¦  1
9  ¦  1
10  ¦  2
11  ¦  2
12  ¦  2
13  ¦  2
14  ¦  2
15  ¦  3
16  ¦  3
17  ¦  3
18  ¦  3
19  ¦  3
20  ¦  3

#SQL[@168,N13]Result[]
DROP TABLE t1;

#SQL[@169,N31]Result[]
create table t1(a varchar(100));

#SQL[@170,N27]Result[]
insert into t1 values ("a");

#SQL[@171,N69]Result[58, 8]
select a, case when a="a" then 1 when upper(a)="b" then 2 end from t1;
a  ¦  case when a = a then 1 when upper(a) = b then 2 end
a  ¦  1

#SQL[@172,N23]Result[]
drop table if exists t1;

