#SQL[@1,N79]Result[]
create table t_dates(
a_date date,
b_datetime datetime,
c_timestamp timestamp
);

#SQL[@7,N84]Result[]
insert into t_dates values('1999-04-05','1999-04-05 11:01:02','1999-04-05 11:01:02');

#SQL[@8,N84]Result[]
insert into t_dates values('2004-04-03','2004-04-03 13:11:10','2004-04-03 13:11:10');

#SQL[@9,N91]Result[]
insert into t_dates values('1999-04-05','1999-04-05 11:01:02','1999-04-05 11:01:02.123456');

#SQL[@10,N91]Result[]
insert into t_dates values('2004-04-03','2004-04-03 13:11:10','2004-04-03 13:11:10.123456');

#SQL[@11,N98]Result[]
insert into t_dates values('1999-04-05','1999-04-05 11:01:02.123456','1999-04-05 11:01:02.123456');

#SQL[@12,N98]Result[]
insert into t_dates values('1999-04-05','2004-04-03 13:11:10.123456','2004-04-03 13:11:10.123456');

#SQL[@17,N124]Result[108, 63, 69, 63, 69, 63, 67]
select date_format(a_date, '%W %M %Y'),date_format(b_datetime, '%W %M %Y'),date_format(c_timestamp, '%W %M %Y') from t_dates;
date_format(a_date, %W %M %Y)  ¦  date_format(b_datetime, %W %M %Y)  ¦  date_format(c_timestamp, %W %M %Y)
Monday April 1999  ¦  Monday April 1999  ¦  Monday April 1999
Saturday April 2004  ¦  Saturday April 2004  ¦  Saturday April 2004
Monday April 1999  ¦  Monday April 1999  ¦  Monday April 1999
Saturday April 2004  ¦  Saturday April 2004  ¦  Saturday April 2004
Monday April 1999  ¦  Monday April 1999  ¦  Monday April 1999
Monday April 1999  ¦  Saturday April 2004  ¦  Saturday April 2004

#SQL[@20,N101]Result[100, 24]
select date_format(NULL, '%W %M %Y'),date_format('1999-04-05 11:01:02', NULL),date_format(NULL, NULL);
date_format(null, %W %M %Y)  ¦  date_format(1999-04-05 11:01:02, null)  ¦  date_format(null, null)
null  ¦  null  ¦  null

#SQL[@24,N135]Result[124, 121]
SELECT DATE_FORMAT('2012-12-21 23:12:34.123456', '%b %M %m %c %D %d %e %j %k %h %i %p %r %T %s %f %U %u %V %v %a %W %w %X %x %Y %y %%');
DATE_FORMAT(2012-12-21 23:12:34.123456, %b %M %m %c %D %d %e %j %k %h %i %p %r %T %s %f %U %u %V %v %a %W %w %X %x %Y %y %%)
Dec December 12 12 21st 21 21 356 23 11 12 PM 11:12:34 PM 23:12:34 34 123456 51 51 51 51 Fri Friday 5 2012 2012 2012 12 %

#SQL[@28,N134]Result[123, 119]
SELECT DATE_FORMAT('2010-01-07 23:12:34.12345', '%b %M %m %c %D %d %e %j %k %h %i %p %r %T %s %f %U %u %V %v %a %W %w %X %x %Y %y %%');
DATE_FORMAT(2010-01-07 23:12:34.12345, %b %M %m %c %D %d %e %j %k %h %i %p %r %T %s %f %U %u %V %v %a %W %w %X %x %Y %y %%)
Jan January 01 1 7th 07 7 007 23 11 12 PM 11:12:34 PM 23:12:34 34 123450 01 01 01 01 Thu Thursday 4 2010 2010 2010 10 %

#SQL[@31,N135]Result[124, 116]
SELECT DATE_FORMAT('0001-01-01 00:00:00.123456', '%b %M %m %c %D %d %e %j %k %h %i %p %r %T %s %f %U %u %V %v %a %W %w %X %x %Y %y %%');
DATE_FORMAT(0001-01-01 00:00:00.123456, %b %M %m %c %D %d %e %j %k %h %i %p %r %T %s %f %U %u %V %v %a %W %w %X %x %Y %y %%)
Jan January 01 1 1st 01 1 001 0 12 00 AM 12:00:00 AM 00:00:00 00 123456 00 01 53 01 Mon Monday 1 0000 0001 0001 01 %

#SQL[@34,N148]Result[137, 133]
SELECT DATE_FORMAT('2012-12-21 23:12:34.123456', 'abc%b %M %m %c %D %d %e %j %k %h %i %p %r %T %s %f %U %u %V %v %a %W %w %X %x %Y %y!123 %%xyz %z');
DATE_FORMAT(2012-12-21 23:12:34.123456, abc%b %M %m %c %D %d %e %j %k %h %i %p %r %T %s %f %U %u %V %v %a %W %w %X %x %Y %y!123 %%xyz %z)
abcDec December 12 12 21st 21 21 356 23 11 12 PM 11:12:34 PM 23:12:34 34 123456 51 51 51 51 Fri Friday 5 2012 2012 2012 12!123 %xyz z

#SQL[@37,N148]Result[135, 69, 69, 69, 69, 69, 69]
select date_format(a_date,'%Y-%m-%d %H:%i:%s'),date_format(b_datetime,'%Y-%m-%d %H:%i:%s'),date_format(c_timestamp,'%Y-%m-%d %H:%i:%s') from t_dates;
date_format(a_date, %Y-%m-%d %H:%i:%s)  ¦  date_format(b_datetime, %Y-%m-%d %H:%i:%s)  ¦  date_format(c_timestamp, %Y-%m-%d %H:%i:%s)
1999-04-05 00:00:00  ¦  1999-04-05 11:01:02  ¦  1999-04-05 11:01:02
2004-04-03 00:00:00  ¦  2004-04-03 13:11:10  ¦  2004-04-03 13:11:10
1999-04-05 00:00:00  ¦  1999-04-05 11:01:02  ¦  1999-04-05 11:01:02
2004-04-03 00:00:00  ¦  2004-04-03 13:11:10  ¦  2004-04-03 13:11:10
1999-04-05 00:00:00  ¦  1999-04-05 11:01:02  ¦  1999-04-05 11:01:02
1999-04-05 00:00:00  ¦  2004-04-03 13:11:10  ¦  2004-04-03 13:11:10

#SQL[@40,N153]Result[132, 44, 44, 44, 44, 44, 44]
select date_format(date('2004-04-03 13:11:10'),'%Y-%m-%d %H:%i:%s'),date_format(cast('2004-04-03 13:11:10' as datetime),'%Y-%m-%d %H:%i:%s') from t_dates;
date_format(date(2004-04-03 13:11:10), %Y-%m-%d %H:%i:%s)  ¦  date_format(cast(2004-04-03 13:11:10 as datetime), %Y-%m-%d %H:%i:%s)
2004-04-03 00:00:00  ¦  2004-04-03 13:11:10
2004-04-03 00:00:00  ¦  2004-04-03 13:11:10
2004-04-03 00:00:00  ¦  2004-04-03 13:11:10
2004-04-03 00:00:00  ¦  2004-04-03 13:11:10
2004-04-03 00:00:00  ¦  2004-04-03 13:11:10
2004-04-03 00:00:00  ¦  2004-04-03 13:11:10

#SQL[@42,N18]Result[]
drop table t_dates;

#SQL[@43,N49]Error[44]
SELECT DATE_FORMAT('123456', '%Y-%m-%d %H:%i:%s');
invalid input: invalid datetime value 123456

#SQL[@44,N59]Result[48, 19]
SELECT DATE_FORMAT('2023-11-08 12:00', '%Y-%m-%d %H:%i:%s');
DATE_FORMAT(2023-11-08 12:00, %Y-%m-%d %H:%i:%s)
2023-11-08 12:00:00

#SQL[@45,N62]Result[51, 19]
SELECT DATE_FORMAT('2023-11-08 15:00:00', '%Y-%m-%d %H:%i:%s');
DATE_FORMAT(2023-11-08 15:00:00, %Y-%m-%d %H:%i:%s)
2023-11-08 15:00:00

#SQL[@46,N60]Result[49, 19]
SELECT DATE_FORMAT('2023-11-08 15:00:', '%Y-%m-%d %H:%i:%s');
DATE_FORMAT(2023-11-08 15:00:, %Y-%m-%d %H:%i:%s)
2023-11-08 15:00:00

#SQL[@48,N106]Error[52]
select date_format('19980021000000', '%H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W');
invalid input: invalid datetime value 19980021000000

#SQL[@49,N106]Result[95, 104]
select date_format('19980131131415', '%H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W');
date_format(19980131131415, %H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W)
13|01|13|1|14|PM|01:14:15 PM|15|13:14:15| January|Saturday|31st|1998|98|Sat|Jan|031|01|31|01|15|Saturday

#SQL[@50,N106]Error[52]
select date_format('19981321000000', '%H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W');
invalid input: invalid datetime value 19981321000000

#SQL[@51,N106]Result[95, 106]
select date_format('19981021000000', '%H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W');
date_format(19981021000000, %H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W)
00|12|0|12|00|AM|12:00:00 AM|00|00:00:00| October|Wednesday|21st|1998|98|Wed|Oct|294|10|21|12|00|Wednesday

#SQL[@52,N106]Error[52]
select date_format('19981033000000', '%H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W');
invalid input: invalid datetime value 19981033000000

#SQL[@53,N106]Result[95, 104]
select date_format('19981031000000', '%H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W');
date_format(19981031000000, %H|%I|%k|%l|%i|%p|%r|%S|%T| %M|%W|%D|%Y|%y|%a|%b|%j|%m|%d|%h|%s|%W)
00|12|0|12|00|AM|12:00:00 AM|00|00:00:00| October|Saturday|31st|1998|98|Sat|Oct|304|10|31|12|00|Saturday

