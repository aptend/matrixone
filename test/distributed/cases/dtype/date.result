#SQL[@7,N62]Error[48]
select cast('0000-01-01' as date),cast('0000-01-01' as date)-1;
invalid argument parsedate, bad value 0000-01-01

#SQL[@8,N33]Result[24, 10]
select cast('2000-01-01' as date);
cast(2000-01-01 as date)
2000-01-01

#SQL[@9,N31]Result[22, 10]
select cast('200-01-1' as date);
cast(200-01-1 as date)
0200-01-01

#SQL[@10,N33]Error[48]
select cast('2021-02-29' as date);
invalid argument parsedate, bad value 2021-02-29

#SQL[@11,N60]Result[51, 2]
select cast('2022-02-01' as date)-cast('2022-01-01' as date);
cast(2022-02-01 as date) - cast(2022-01-01 as date)
31

#SQL[@12,N38]Result[31, 4]
select cast('2020-02-01' as date)+NULL;
cast(2020-02-01 as date) + null
null

#SQL[@13,N33]Error[48]
select cast('0000-00-00' as date);
invalid argument parsedate, bad value 0000-00-00

#SQL[@14,N46]Error[55]
select cast(cast(0x13488c5 as signed) as date);
invalid argument operator cast, bad value [BIGINT DATE]

#SQL[@16,N46]Result[39, 26]
SELECT DATE_ADD('2017-06-15', INTERVAL 10 DAY);
DATE_ADD(2017-06-15, INTERVAL(10, day))
2017-06-25 00:00:00.000000

#SQL[@17,N48]Result[41, 26]
SELECT DATE_ADD('2017-06-15', INTERVAL 10 MONTH);
DATE_ADD(2017-06-15, INTERVAL(10, month))
2018-04-15 00:00:00.000000

#SQL[@18,N46]Result[39, 26]
SELECT DATE_ADD('2017-06-15', INTERVAL 1 YEAR);
DATE_ADD(2017-06-15, INTERVAL(1, year))
2018-06-15 00:00:00.000000

#SQL[@19,N44]Result[37, 26]
SELECT DATE_ADD('20200215', INTERVAL 14 DAY);
DATE_ADD(20200215, INTERVAL(14, day))
2020-02-29 00:00:00.000000

#SQL[@22,N23]Result[]
drop table if exists t1;

#SQL[@23,N49]Result[]
create table t1 (a date not null, primary key(a));

#SQL[@24,N78]Result[]
insert into t1 values ('2022-01-01'), ('20220102'),('2022-01-03'),('20220104');

#SQL[@25,N31]Result[1, 10, 10, 10, 10]
select * from t1 order by a asc;
a
2022-01-01
2022-01-02
2022-01-03
2022-01-04

#SQL[@26,N53]Result[1, 10]
select * from t1 where a='2022-01-01' order by 1 desc;
a
2022-01-01

#SQL[@27,N31]Result[]
delete from t1 where a=20220102;

#SQL[@28,N51]Result[1, 10, 10, 10]
select * from t1 where a<>'20220104' order by 1 asc;
a
2022-01-01
2022-01-02
2022-01-03

#SQL[@29,N49]Result[]
update t1 set a='2022-02-02' where a='2022-01-03';

#SQL[@30,N16]Result[1, 10, 10, 10, 10]
select * from t1;
a
2022-01-01
2022-01-02
2022-01-04
2022-02-02

#SQL[@31,N13]Result[]
drop table t1;

#SQL[@32,N65]Result[]
create table t1 ( a int not null default 1, big date primary key);

#SQL[@33,N72]Result[]
insert into t1 (big) values ('2000-01-01'),('2001-01-01'),('2002-01-01');

#SQL[@34,N41]Result[10, 17, 17, 17]
select * from t1 order by a desc, big asc;
a  ¦  big
1  ¦  2000-01-01
1  ¦  2001-01-01
1  ¦  2002-01-01

#SQL[@35,N39]Result[10, 17, 17]
select * from t1 order by big limit 1,2;
a  ¦  big
1  ¦  2001-01-01
1  ¦  2002-01-01

#SQL[@36,N46]Result[10, 17, 17]
select * from t1 order by big limit 2 offset 1;
a  ¦  big
1  ¦  2001-01-01
1  ¦  2002-01-01

#SQL[@37,N64]Result[]
select distinct big from t1 where big=20000101 order by big desc;

#SQL[@38,N43]Result[40, 37]
select min(big),max(big),max(big)-1 from t1;
min(big)  ¦  max(big)  ¦  max(big) - 1
2000-01-01  ¦  2002-01-01  ¦  11687

#SQL[@39,N80]Error[57]
select min(big),avg(big),count(big)+1 from t1 group by big order by 1 asc, 2 asc;
invalid argument aggregate function avg, bad value [DATE]

#SQL[@41,N13]Result[]
drop table t1;

#SQL[@42,N79]Result[]
create table t1 (id date not null default '2022-01-31', a int, primary key (a));

#SQL[@43,N28]Result[]
insert into t1(a) values (1);

#SQL[@44,N16]Result[9, 17]
select * from t1;
id  ¦  a
2022-01-31  ¦  1

#SQL[@47,N23]Result[]
drop table if exists t1;

#SQL[@48,N23]Result[]
drop table if exists t2;

#SQL[@49,N89]Result[]
create table t1 (
dvalue  date not null,
value32  integer not null,
primary key(dvalue)
);

#SQL[@54,N89]Result[]
create table t2 (
dvalue  date not null,
value32  integer not null,
primary key(dvalue)
);

#SQL[@59,N38]Result[]
insert into t1 values('2022-01-01', 1);

#SQL[@60,N38]Result[]
insert into t1 values('2022-01-02', 2);

#SQL[@61,N38]Result[]
insert into t2 values('2022-01-03', 3);

#SQL[@62,N38]Result[]
insert into t2 values('2022-01-02', 4);

#SQL[@63,N38]Result[]
insert into t2 values('2022-01-01', 5);

#SQL[@64,N16]Result[19, 17, 17]
select * from t1;
dvalue  ¦  value32
2022-01-01  ¦  1
2022-01-02  ¦  2

#SQL[@65,N32]Result[19, 17, 17, 17]
select * from t2 order by 2 desc;
dvalue  ¦  value32
2022-01-01  ¦  5
2022-01-02  ¦  4
2022-01-03  ¦  3

#SQL[@66,N78]Result[44, 40, 40]
select * from t1 join t2 on t1.dvalue=t2.dvalue order by 1 desc,t2.value32 asc;
dvalue  ¦  value32  ¦  dvalue  ¦  value32
2022-01-02  ¦  2  ¦  2022-01-02  ¦  4
2022-01-01  ¦  1  ¦  2022-01-01  ¦  5

#SQL[@67,N115]Error[110]
select * from t1 join t2 on t1.dvalue=t2.dvalue where t1.dvalue>='2022-01-01' group by t1.dvalue order by t2.dvalue;
SQL syntax error: column \"t1.value32\" must appear in the GROUP BY clause or be used in an aggregate function

#SQL[@70,N23]Result[]
drop table if exists t1;

#SQL[@71,N23]Result[]
drop table if exists t2;

#SQL[@72,N28]Result[]
CREATE TABLE t_date(id date);

#SQL[@73,N56]Result[]
insert INTO t_date VALUES ('2020-01-01'), ('2022-01-02');

#SQL[@74,N37]Result[22, 21, 21]
SELECT id, id >= 20200102 FROM t_date;
id  ¦  id >= 20200102
2020-01-01  ¦  false
2022-01-02  ¦  false

#SQL[@75,N42]Error[58]
SELECT id, 1.1 <= '2020-01-01' FROM t_date;
strconv.ParseFloat: parsing \"2020-01-01\": invalid syntax

#SQL[@76,N37]Result[22, 21, 21]
SELECT id, id = 202020101 FROM t_date;
id  ¦  id = 202020101
2020-01-01  ¦  false
2022-01-02  ¦  false

#SQL[@77,N38]Result[21, 20, 21]
SELECT id, '20200101' = id FROM t_date;
id  ¦  20200101 = id
2020-01-01  ¦  true
2022-01-02  ¦  false

#SQL[@78,N40]Result[]
SELECT * from t_date WHERE id = 20200101;

#SQL[@79,N43]Error[52]
SELECT * from t_date WHERE id = 2.0200101e7;
invalid argument operator =, bad value [DATE DOUBLE]

#SQL[@80,N42]Result[2, 10]
SELECT * from t_date WHERE id = '20200101';
id
2020-01-01

#SQL[@81,N60]Result[2, 10]
SELECT * from t_date WHERE id IN ('2020-01-01','2022-01-03');
id
2020-01-01

#SQL[@82,N59]Error[52]
SELECT * from t_date WHERE id IN (2.0200101e7,2.0200103e7 );
invalid argument operator =, bad value [DATE DOUBLE]

#SQL[@83,N53]Result[]
SELECT * from t_date WHERE id IN (20220101, 20220103);

#SQL[@84,N62]Error[49]
SELECT * from t_date WHERE id IN ('2.0200101e7','2.0200103e7');
invalid argument parsedate, bad value 2.0200101e7

#SQL[@85,N59]Result[]
SELECT * from t_date WHERE id BETWEEN 20191231 AND 20200101;

#SQL[@86,N65]Error[53]
SELECT * from t_date WHERE id BETWEEN 2.0200101e7 and 2.0200103e7;
invalid argument operator >=, bad value [DATE DOUBLE]

#SQL[@87,N67]Result[]
SELECT * from t_date WHERE id BETWEEN '2020-01-02' AND '2020-01-03';

#SQL[@88,N69]Error[49]
SELECT * from t_date WHERE id BETWEEN '2.0200101e7' and '2.0200103e7';
invalid argument parsedate, bad value 2.0200101e7

#SQL[@89,N23]Result[]
drop table if exists t1;

#SQL[@90,N24]Result[]
CREATE TABLE t1 (a date);

#SQL[@91,N36]Result[]
insert INTO t1 VALUES ('2022-03-01');

#SQL[@92,N72]Result[1, 10]
SELECT * FROM t1 WHERE coalesce(a) BETWEEN '2022-02-28' and '2022-03-01';
a
2022-03-01

#SQL[@93,N45]Result[1, 10]
SELECT * FROM t1 WHERE coalesce(a)='20220301';
a
2022-03-01

#SQL[@94,N65]Result[1, 10]
SELECT * FROM t1 WHERE coalesce(a) in ('2022-02-28','2022-03-01');
a
2022-03-01

#SQL[@95,N13]Result[]
drop table t1;

#SQL[@96,N53]Error[55]
SELECT CAST(20220101 AS date) BETWEEN 20220101 AND -1;
invalid argument operator cast, bad value [BIGINT DATE]

#SQL[@97,N52]Error[55]
SELECT CAST(00000501 AS date) NOT BETWEEN 100 AND -1;
invalid argument operator cast, bad value [BIGINT DATE]

#SQL[@98,N39]Error[55]
SELECT CAST(0 AS date) BETWEEN 0 AND -1;
invalid argument operator cast, bad value [BIGINT DATE]

#SQL[@99,N67]Error[55]
SELECT CAST(10000101 as date) BETWEEN '1000-01-01' and '1000-01-02';
invalid argument operator cast, bad value [BIGINT DATE]

#SQL[@102,N23]Result[]
drop table if exists t1;

#SQL[@103,N23]Result[]
drop table if exists t2;

#SQL[@104,N23]Result[]
drop table if exists t3;

#SQL[@105,N24]Result[]
drop table if exists t21;

#SQL[@106,N24]Result[]
drop table if exists t12;

#SQL[@107,N43]Result[]
CREATE TABLE t1 (a date, b int primary key);

#SQL[@108,N55]Result[]
insert INTO t1 VALUES ('2022-01-01',1),('2022-01-01',2);

#SQL[@109,N57]Result[]
update t1 set a='2022-01-02' where a='2022-01-01' limit 1;

#SQL[@110,N16]Result[8, 17, 17]
select * from t1;
a  ¦  b
2022-01-01  ¦  2
2022-01-02  ¦  1

#SQL[@111,N38]Result[]
insert INTO t1 VALUES ('2022-01-01',3);

#SQL[@112,N49]Result[]
update t1 set a='2022-01-02' where a='2022-01-01';

#SQL[@113,N16]Result[8, 17, 17, 17]
select * from t1;
a  ¦  b
2022-01-02  ¦  1
2022-01-02  ¦  2
2022-01-02  ¦  3

#SQL[@114,N13]Result[]
drop table t1;

#SQL[@115,N73]Result[]
create table t1 (
a date not null,
b date not null default '2000-01-01'
);

#SQL[@119,N115]Result[]
insert into t1 (a) values ('2022-01-02'),('2022-01-04'),('2022-01-06'),('2022-01-08'),('2022-01-10'),('2022-01-12');

#SQL[@120,N21]Error[55]
update t1 set a=a+101;
invalid argument operator cast, bad value [BIGINT DATE]

#SQL[@121,N18]Result[8, 26, 26, 26, 26, 26, 26]
select a,b from t1;
a  ¦  b
2022-01-02  ¦  2000-01-01
2022-01-04  ¦  2000-01-01
2022-01-06  ¦  2000-01-01
2022-01-08  ¦  2000-01-01
2022-01-10  ¦  2000-01-01
2022-01-12  ¦  2000-01-01

#SQL[@122,N49]Result[]
update t1 set a='2022-01-27' where a='2022-02-05';

#SQL[@123,N18]Result[8, 26, 26, 26, 26, 26, 26]
select a,b from t1;
a  ¦  b
2022-01-02  ¦  2000-01-01
2022-01-04  ¦  2000-01-01
2022-01-06  ¦  2000-01-01
2022-01-08  ¦  2000-01-01
2022-01-10  ¦  2000-01-01
2022-01-12  ¦  2000-01-01

#SQL[@124,N31]Error[55]
update t1 set a=a-1 where 1 > 2;
invalid argument operator cast, bad value [BIGINT DATE]

#SQL[@125,N18]Result[8, 26, 26, 26, 26, 26, 26]
select a,b from t1;
a  ¦  b
2022-01-02  ¦  2000-01-01
2022-01-04  ¦  2000-01-01
2022-01-06  ¦  2000-01-01
2022-01-08  ¦  2000-01-01
2022-01-10  ¦  2000-01-01
2022-01-12  ¦  2000-01-01

#SQL[@126,N31]Error[55]
update t1 set a=a-1 where 3 > 2;
invalid argument operator cast, bad value [BIGINT DATE]

#SQL[@127,N18]Result[8, 26, 26, 26, 26, 26, 26]
select a,b from t1;
a  ¦  b
2022-01-02  ¦  2000-01-01
2022-01-04  ¦  2000-01-01
2022-01-06  ¦  2000-01-01
2022-01-08  ¦  2000-01-01
2022-01-10  ¦  2000-01-01
2022-01-12  ¦  2000-01-01

#SQL[@129,N13]Result[]
drop table t1;

#SQL[@130,N48]Result[]
create table t1 (a date primary key, b char(32));

#SQL[@131,N65]Result[]
insert into t1 values ('20220101','apple'),('2022-01-02','apple');

#SQL[@132,N16]Result[8, 21, 21]
select * from t1;
a  ¦  b
2022-01-01  ¦  apple
2022-01-02  ¦  apple

#SQL[@135,N23]Result[]
drop table if exists t1;

#SQL[@136,N23]Result[]
drop table if exists t2;

#SQL[@137,N23]Result[]
drop table if exists t3;

#SQL[@138,N24]Result[]
drop table if exists t11;

#SQL[@139,N24]Result[]
drop table if exists t12;

#SQL[@140,N43]Result[]
CREATE TABLE t1 (a date, b int primary key);

#SQL[@141,N55]Result[]
insert INTO t1 VALUES ('2022-01-01',1),('2022-01-01',2);

#SQL[@142,N43]Result[]
delete from t1 where a='2022-01-01' limit 1;

#SQL[@143,N16]Result[8, 17]
select * from t1;
a  ¦  b
2022-01-01  ¦  2

#SQL[@144,N38]Result[]
insert INTO t1 VALUES ('2022-01-01',3);

#SQL[@145,N35]Result[]
delete from t1 where a='2022-01-01';

#SQL[@146,N16]Result[]
select * from t1;

#SQL[@147,N13]Result[]
drop table t1;

#SQL[@148,N72]Result[]
create table t1 (
a date not null,
b date not null default '2000-01-01');

#SQL[@151,N115]Result[]
insert into t1 (a) values ('2022-01-02'),('2022-01-04'),('2022-01-06'),('2022-01-08'),('2022-01-10'),('2022-01-12');

#SQL[@152,N33]Result[]
delete from t1 where a=20220101+3;

#SQL[@153,N18]Result[8, 26, 26, 26, 26, 26, 26]
select a,b from t1;
a  ¦  b
2022-01-02  ¦  2000-01-01
2022-01-04  ¦  2000-01-01
2022-01-06  ¦  2000-01-01
2022-01-08  ¦  2000-01-01
2022-01-10  ¦  2000-01-01
2022-01-12  ¦  2000-01-01

#SQL[@154,N27]Result[]
delete from t1 where  3 < 2;

#SQL[@155,N18]Result[8, 26, 26, 26, 26, 26, 26]
select a,b from t1;
a  ¦  b
2022-01-02  ¦  2000-01-01
2022-01-04  ¦  2000-01-01
2022-01-06  ¦  2000-01-01
2022-01-08  ¦  2000-01-01
2022-01-10  ¦  2000-01-01
2022-01-12  ¦  2000-01-01

#SQL[@156,N27]Result[]
delete from t1 where  1 < 2;

#SQL[@157,N18]Result[]
select a,b from t1;

#SQL[@159,N13]Result[]
drop table t1;

#SQL[@160,N48]Result[]
create table t1 (a date primary key, b char(32));

#SQL[@161,N65]Result[]
insert into t1 values ('20220101','apple'),('2022-01-02','apple');

#SQL[@162,N16]Result[8, 21, 21]
select * from t1;
a  ¦  b
2022-01-01  ¦  apple
2022-01-02  ¦  apple

