#SQL[@1,N23]Result[]
drop table if exists t1;

#SQL[@2,N36]Result[]
create table t1(a int,b text,c text);

#SQL[@3,N74]Result[]
insert into t1 values(1,"a","bc"),(2,"ab","c"),(3,"aa","bb"),(3,"aa","bb");

#SQL[@4,N57]Result[33, 15]
select group_concat(distinct a,b,c separator '|') from t1;
group_concat(distinct a, b, c, |)
1abc|2abc|3aabb

#SQL[@5,N66]Result[30, 3, 3, 4]
select group_concat(distinct b,c separator '|') from t1 group by a;
group_concat(distinct b, c, |)
abc
abc
aabb

#SQL[@6,N55]Result[30, 12]
select group_concat(distinct b,c separator '|') from t1;
group_concat(distinct b, c, |)
abc|abc|aabb

#SQL[@7,N38]Result[]
set @@sql_mode = "STRICT_TRANS_TABLES";

#SQL[@8,N57]Result[37, 19]
select group_concat(distinct b,c separator '|'),a from t1;
group_concat(distinct b, c, |)  ¦  a
abc|abc|aabb  ¦  1

#SQL[@9,N57]Result[37, 19]
select a,group_concat(distinct b,c separator '|') from t1;
a  ¦  group_concat(distinct b, c, |)
1  ¦  abc|abc|aabb

#SQL[@10,N62]Result[42, 22]
select group_concat(distinct b,c separator '|'),avg(a) from t1;
group_concat(distinct b, c, |)  ¦  avg(a)
abc|abc|aabb  ¦  2.25

#SQL[@11,N62]Result[42, 22]
select avg(a),group_concat(distinct b,c separator '|') from t1;
avg(a)  ¦  group_concat(distinct b, c, |)
2.25  ¦  abc|abc|aabb

#SQL[@12,N62]Result[42, 19]
select group_concat(distinct b,c separator '|'),sum(a) from t1;
group_concat(distinct b, c, |)  ¦  sum(a)
abc|abc|aabb  ¦  9

#SQL[@13,N62]Result[42, 19]
select sum(a),group_concat(distinct b,c separator '|') from t1;
sum(a)  ¦  group_concat(distinct b, c, |)
9  ¦  abc|abc|aabb

#SQL[@14,N68]Result[37, 10, 10, 11]
select group_concat(distinct b,c separator '|'),a from t1 group by a;
group_concat(distinct b, c, |)  ¦  a
abc  ¦  1
abc  ¦  2
aabb  ¦  3

#SQL[@15,N68]Result[37, 10, 10, 11]
select a,group_concat(distinct b,c separator '|') from t1 group by a;
a  ¦  group_concat(distinct b, c, |)
1  ¦  abc
2  ¦  abc
3  ¦  aabb

#SQL[@16,N73]Result[42, 10, 10, 11]
select group_concat(distinct b,c separator '|'),avg(a) from t1 group by a;
group_concat(distinct b, c, |)  ¦  avg(a)
abc  ¦  1
abc  ¦  2
aabb  ¦  3

#SQL[@17,N73]Result[42, 10, 10, 11]
select avg(a),group_concat(distinct b,c separator '|') from t1 group by a;
avg(a)  ¦  group_concat(distinct b, c, |)
1  ¦  abc
2  ¦  abc
3  ¦  aabb

#SQL[@18,N73]Result[42, 10, 10, 11]
select group_concat(distinct b,c separator '|'),sum(a) from t1 group by a;
group_concat(distinct b, c, |)  ¦  sum(a)
abc  ¦  1
abc  ¦  2
aabb  ¦  6

#SQL[@19,N73]Result[42, 10, 10, 11]
select sum(a),group_concat(distinct b,c separator '|') from t1 group by a;
sum(a)  ¦  group_concat(distinct b, c, |)
1  ¦  abc
2  ¦  abc
6  ¦  aabb

#SQL[@20,N23]Result[]
drop table if exists t1;

#SQL[@21,N33]Result[]
create table t1(a int, b char(1));

#SQL[@22,N30]Result[]
insert into t1 values (1, 'a');

#SQL[@23,N80]Error[41]
select group_concat(a) as bb, case b when 1 then '是' else '否' end aa from t1;
invalid argument cast to int, bad value a

#SQL[@24,N80]Result[10, 10]
select group_concat(b) as bb, case a when 1 then '是' else '否' end aa from t1;
bb  ¦  aa
a  ¦  是

#SQL[@25,N136]Result[]
set @@sql_mode = "ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION";

