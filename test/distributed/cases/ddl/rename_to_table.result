#SQL[@2,N61]Result[]
create table rename_table_01(a int primary key,b varchar(10));

#SQL[@3,N68]Result[]
insert into rename_table_01 values(10,'pear'),(11,'yeap'),(23,'sss');

#SQL[@4,N40]Result[]
rename table rename_table_01 to `123456`;

#SQL[@5,N22]Result[8, 12, 12, 11]
select * from `123456`;
a  ¦  b
10  ¦  pear
11  ¦  yeap
23  ¦  sss

#SQL[@6,N29]Error[58]
select * from rename_table_01;
SQL parser error: table \"rename_table_01\" does not exist

#SQL[@7,N19]Result[]
drop table `123456`;

#SQL[@8,N58]Result[]
create table rename_table_02(a int not null,b varchar(10));

#SQL[@9,N41]Result[]
rename table rename_table_02 to _rename02;

#SQL[@10,N20]Result[]
drop table _rename02;

#SQL[@11,N64]Result[]
create table rename_table_03(a int ,b varchar(10),UNIQUE KEY(a));

#SQL[@12,N65]Result[]
insert into rename_table_03 values(20,'ste'),(22,'ip'),(24,'opt');

#SQL[@13,N43]Error[202]
rename table rename_table_03 to test@123456;
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 43 near \"@123456\";

#SQL[@14,N45]Result[]
rename table rename_table_03 to `test@123456`;

#SQL[@15,N27]Result[8, 11, 10, 11]
select * from `test@123456`;
a  ¦  b
20  ¦  ste
22  ¦  ip
24  ¦  opt

#SQL[@16,N24]Result[]
drop table `test@123456`;

#SQL[@17,N50]Result[]
create table rename_table_04(a int,b decimal(5,3));

#SQL[@18,N64]Result[]
insert into rename_table_04 values(20,3.56),(22,52.02),(24,59.1);

#SQL[@19,N40]Result[]
rename table rename_table_04 to `中文`;

#SQL[@20,N22]Result[8, 13, 14, 14]
select * from `中文`;
a  ¦  b
20  ¦  3.560
22  ¦  52.020
24  ¦  59.100

#SQL[@21,N19]Result[]
drop table `中文`;

#SQL[@22,N76]Result[]
create table rename_table_05(a int auto_increment primary key,b varchar(10));

#SQL[@23,N57]Result[]
insert into rename_table_05(b) values('ui'),('we'),('mn');

#SQL[@24,N46]Result[]
rename table rename_table_05 to `ff@#$%^&*()!`;

#SQL[@25,N28]Result[8, 9, 9, 9]
select * from `ff@#$%^&*()!`;
a  ¦  b
1  ¦  ui
2  ¦  we
3  ¦  mn

#SQL[@26,N25]Result[]
drop table `ff@#$%^&*()!`;

#SQL[@27,N58]Result[]
create table rename_table_06(a int not null,b varchar(10));

#SQL[@28,N65]Result[]
insert into rename_table_06 values(20,'ste'),(22,'ip'),(24,'opt');

#SQL[@29,N38]Result[]
rename table rename_table_06 to `Fast`;

#SQL[@30,N20]Result[8, 11, 10, 11]
select * from `fast`;
a  ¦  b
20  ¦  ste
22  ¦  ip
24  ¦  opt

#SQL[@31,N20]Result[8, 11, 10, 11]
select * from `Fast`;
a  ¦  b
20  ¦  ste
22  ¦  ip
24  ¦  opt

#SQL[@32,N17]Result[]
drop table `fast`;

#SQL[@33,N49]Result[]
create table rename_table_07(a int,b varchar(10));

#SQL[@34,N34]Error[198]
rename table rename_table_07 to ``;
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 33 near \" ``\";

#SQL[@35,N26]Result[]
drop table rename_table_07;

#SQL[@36,N49]Result[]
create table rename_table_08(a int,b varchar(10));

#SQL[@37,N40]Result[]
rename table rename_table_08 to `rename`;

#SQL[@38,N19]Result[]
drop table `rename`;

#SQL[@41,N49]Result[]
create table rename_table_09(a int,b varchar(10));

#SQL[@42,N49]Result[]
create table rename_table_10(a int,b varchar(10));

#SQL[@43,N65]Result[]
insert into rename_table_10 values(20,'ste'),(22,'ip'),(24,'opt');

#SQL[@45,N47]Error[36]
rename table rename_table_10 to rename_table_09;
table rename_table_09 already exists

#SQL[@47,N26]Result[]
drop table rename_table_09;

#SQL[@48,N26]Result[]
drop table rename_table_10;

#SQL[@50,N76]Result[]
create table rename_table_11(a int primary key auto_increment,b varchar(10));

#SQL[@51,N63]Result[]
insert into rename_table_11(b) values ('key'),('aabb'),('ccdd');

#SQL[@52,N47]Result[]
rename table rename_table_11 to rename_table_12;

#SQL[@53,N29]Result[8, 10, 11, 11]
select * from rename_table_12;
a  ¦  b
1  ¦  key
2  ¦  aabb
3  ¦  ccdd

#SQL[@54,N47]Result[]
rename table rename_table_12 to rename_table_11;

#SQL[@55,N29]Result[8, 10, 11, 11]
select * from rename_table_11;
a  ¦  b
1  ¦  key
2  ¦  aabb
3  ¦  ccdd

#SQL[@56,N26]Result[]
drop table rename_table_11;

#SQL[@59,N76]Result[]
create table rename_table_20(a int primary key auto_increment,b varchar(10));

#SQL[@60,N62]Result[]
insert into rename_table_20(b) values ('key'),('tab'),('rows');

#SQL[@61,N38]Result[]
rename table rename_table_20 to rf0123;

#SQL[@62,N56]Result[]
insert into rf0123(b) values ('key1'),('tab1'),('rows1');

#SQL[@63,N20]Result[8, 10, 10, 11, 11, 11, 12]
select * from rf0123;
a  ¦  b
1  ¦  key
2  ¦  tab
3  ¦  rows
4  ¦  key1
5  ¦  tab1
6  ¦  rows1

#SQL[@64,N32]Result[]
update rf0123 set a=10 where a=1;

#SQL[@65,N20]Result[8, 10, 11, 11, 11, 12, 11]
select * from rf0123;
a  ¦  b
2  ¦  tab
3  ¦  rows
4  ¦  key1
5  ¦  tab1
6  ¦  rows1
10  ¦  key

#SQL[@66,N28]Result[]
delete from rf0123 where a=3;

#SQL[@67,N20]Result[8, 10, 11, 11, 12, 11]
select * from rf0123;
a  ¦  b
2  ¦  tab
4  ¦  key1
5  ¦  tab1
6  ¦  rows1
10  ¦  key

#SQL[@68,N21]Result[]
truncate table rf0123;

#SQL[@69,N20]Result[]
select * from rf0123;

#SQL[@70,N17]Result[]
drop table rf0123;

#SQL[@73,N76]Result[]
create table rename_table_05(a int primary key auto_increment,b varchar(10));

#SQL[@74,N62]Result[]
insert into rename_table_05(b) values ('key'),('tab'),('rows');

#SQL[@75,N59]Result[]
create view rename_view_05 as select * from rename_table_05;

#SQL[@76,N37]Result[]
rename table rename_table_05 to rt_05;

#SQL[@77,N19]Result[8, 10, 10, 11]
select * from rt_05;
a  ¦  b
1  ¦  key
2  ¦  tab
3  ¦  rows

#SQL[@78,N28]Error[58]
select * from rename_view_05;
SQL parser error: table \"rename_table_05\" does not exist

#SQL[@79,N16]Result[]
drop table rt_05;

#SQL[@80,N25]Error[44]
drop table rename_view_05;
no such table rename_to_table.rename_view_05

#SQL[@83,N65]Result[]
create table rename_table_21(a bigint primary key,b decimal(5,3));

#SQL[@84,N70]Result[]
insert into rename_table_21 values(1258,0.762),(157,21.25),(958,44.85);

#SQL[@85,N36]Result[]
rename table rename_table_21 to w_01;

#SQL[@86,N22]Result[23, 109]
show create table w_01;
Table  ¦  Create Table
w_01  ¦  CREATE TABLE `w_01` (
  `a` bigint NOT NULL,
  `b` decimal(5,3) DEFAULT NULL,
  PRIMARY KEY (`a`)
)

#SQL[@87,N33]Result[]
alter table w_01 drop primary key;

#SQL[@88,N22]Result[23, 88]
show create table w_01;
Table  ¦  Create Table
w_01  ¦  CREATE TABLE `w_01` (
  `a` bigint NOT NULL,
  `b` decimal(5,3) DEFAULT NULL
)

#SQL[@89,N15]Result[]
drop table w_01;

#SQL[@91,N84]Result[]
create table rename_table_22(a bigint,b decimal(5,3),c varchar(10),primary key(a,c));

#SQL[@92,N93]Result[]
insert into rename_table_22 values(1,0.762,'0102934'),(2,21.25,'0103084'),(1,44.85,'0104552');

#SQL[@93,N36]Result[]
rename table rename_table_22 to w_02;

#SQL[@94,N22]Result[23, 141]
show create table w_02;
Table  ¦  Create Table
w_02  ¦  CREATE TABLE `w_02` (
  `a` bigint NOT NULL,
  `b` decimal(5,3) DEFAULT NULL,
  `c` varchar(10) NOT NULL,
  PRIMARY KEY (`a`,`c`)
)

#SQL[@95,N33]Result[]
alter table w_02 drop primary key;

#SQL[@96,N22]Result[23, 116]
show create table w_02;
Table  ¦  Create Table
w_02  ¦  CREATE TABLE `w_02` (
  `a` bigint NOT NULL,
  `b` decimal(5,3) DEFAULT NULL,
  `c` varchar(10) NOT NULL
)

#SQL[@97,N15]Result[]
drop table w_02;

#SQL[@100,N71]Result[]
create table rename_table_23(a bigint,b decimal(5,3),unique key idx(a));

#SQL[@101,N70]Result[]
insert into rename_table_23 values(1002,0.762),(743,21.25),(958,44.85);

#SQL[@102,N36]Result[]
rename table rename_table_23 to w_03;

#SQL[@103,N31]Result[]
alter table w_03 drop index idx;

#SQL[@104,N22]Result[23, 92]
show create table w_03;
Table  ¦  Create Table
w_03  ¦  CREATE TABLE `w_03` (
  `a` bigint DEFAULT NULL,
  `b` decimal(5,3) DEFAULT NULL
)

#SQL[@105,N41]Result[]
alter table w_03 add unique index idx1(a);

#SQL[@106,N22]Result[23, 119]
show create table w_03;
Table  ¦  Create Table
w_03  ¦  CREATE TABLE `w_03` (
  `a` bigint DEFAULT NULL,
  `b` decimal(5,3) DEFAULT NULL,
  UNIQUE KEY `idx1` (`a`)
)

#SQL[@107,N15]Result[]
drop table w_03;

#SQL[@110,N73]Result[]
create table rename_fk_01(col1 varchar(30) not null primary key,col2 int);

#SQL[@111,N127]Result[]
create table rename_fk_02(col1 int,col2 varchar(25),col3 tinyint,constraint ck foreign key(col2) REFERENCES rename_fk_01(col1));

#SQL[@112,N30]Result[23, 254]
show create table rename_fk_02;
Table  ¦  Create Table
rename_fk_02  ¦  CREATE TABLE `rename_fk_02` (
  `col1` int DEFAULT NULL,
  `col2` varchar(25) DEFAULT NULL,
  `col3` tinyint DEFAULT NULL,
  CONSTRAINT `ck` FOREIGN KEY (`col2`) REFERENCES `rename_fk_01` (`col1`) ON DELETE RESTRICT ON UPDATE RESTRICT
)

#SQL[@113,N66]Result[]
insert into rename_fk_01 values ('90',5983),('100',734),('190',50);

#SQL[@114,N80]Result[]
insert into rename_fk_02(col2,col3) values ('90',5),('90',4),('100',0),(NULL,80);

#SQL[@115,N26]Result[14, 12, 12, 11]
select * from rename_fk_01;
col1  ¦  col2
90  ¦  5983
100  ¦  734
190  ¦  50

#SQL[@116,N26]Result[24, 19, 19, 20, 22]
select * from rename_fk_02;
col1  ¦  col2  ¦  col3
null  ¦  90  ¦  5
null  ¦  90  ¦  4
null  ¦  100  ¦  0
null  ¦  null  ¦  80

#SQL[@117,N52]Error[80]
insert into rename_fk_02(col2,col3) values ('200',5);
internal error: Cannot add or update a child row: a foreign key constraint fails

#SQL[@118,N33]Result[]
rename table rename_fk_02 to w_04;

#SQL[@119,N22]Result[23, 238]
show create table w_04;
Table  ¦  Create Table
w_04  ¦  CREATE TABLE `w_04` (
  `col1` int DEFAULT NULL,
  `col2` varchar(25) DEFAULT NULL,
  `col3` tinyint DEFAULT NULL,
  CONSTRAINT `ck` FOREIGN KEY (`col2`) REFERENCES `rename_fk_01` (`col1`) ON DELETE RESTRICT ON UPDATE RESTRICT
)

#SQL[@120,N65]Result[]
insert into rename_fk_01 values ('200',983),('300',45),('400',23);

#SQL[@121,N64]Error[80]
insert into w_04(col2,col3) values ('400',5),('500',4),('300',0);
internal error: Cannot add or update a child row: a foreign key constraint fails

#SQL[@122,N18]Result[24, 19, 19, 20, 22]
select * from w_04;
col1  ¦  col2  ¦  col3
null  ¦  90  ¦  5
null  ¦  90  ¦  4
null  ¦  100  ¦  0
null  ¦  null  ¦  80

#SQL[@123,N36]Result[]
alter table w_04 drop foreign key ck;

#SQL[@124,N22]Result[23, 125]
show create table w_04;
Table  ¦  Create Table
w_04  ¦  CREATE TABLE `w_04` (
  `col1` int DEFAULT NULL,
  `col2` varchar(25) DEFAULT NULL,
  `col3` tinyint DEFAULT NULL
)

#SQL[@125,N15]Result[]
drop table w_04;

#SQL[@128,N113]Result[]
create table rename_table_25(a int primary key auto_increment,b varchar(10) not null,c decimal(5,3) default 0.05);

#SQL[@129,N79]Result[]
insert into rename_table_25(b,c) values('nnnn',0.5),('jeep',23.43),('moon',2.3);

#SQL[@130,N36]Result[]
rename table rename_table_25 to w_05;

#SQL[@131,N22]Result[23, 149]
show create table w_05;
Table  ¦  Create Table
w_05  ¦  CREATE TABLE `w_05` (
  `a` int NOT NULL AUTO_INCREMENT,
  `b` varchar(10) NOT NULL,
  `c` decimal(5,3) DEFAULT 0.05,
  PRIMARY KEY (`a`)
)

#SQL[@132,N15]Result[]
drop table w_05;

#SQL[@135,N76]Result[]
create table rename_table_26(a int primary key auto_increment,b varchar(10));

#SQL[@136,N63]Result[]
insert into rename_table_26(b) values ('kimi'),('red'),('lipo');

#SQL[@137,N36]Result[]
rename table rename_table_26 to w_06;

#SQL[@138,N55]Result[]
alter table w_06 add column c decimal(4,2) default 0.05;

#SQL[@139,N37]Result[]
alter table w_06 modify b varchar(20);

#SQL[@140,N22]Result[23, 153]
show create table w_06;
Table  ¦  Create Table
w_06  ¦  CREATE TABLE `w_06` (
  `a` int NOT NULL AUTO_INCREMENT,
  `b` varchar(20) DEFAULT NULL,
  `c` decimal(4,2) DEFAULT 0.05,
  PRIMARY KEY (`a`)
)

#SQL[@141,N30]Result[]
alter table w_06 drop column c;

#SQL[@142,N22]Result[23, 120]
show create table w_06;
Table  ¦  Create Table
w_06  ¦  CREATE TABLE `w_06` (
  `a` int NOT NULL AUTO_INCREMENT,
  `b` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`)
)

#SQL[@143,N15]Result[]
drop table w_06;

#SQL[@146,N76]Result[]
create table rename_table_01(a int primary key auto_increment,b varchar(10));

#SQL[@147,N76]Result[]
create table rename_table_02(a int primary key auto_increment,b varchar(10));

#SQL[@148,N76]Result[]
create table rename_table_03(a int primary key auto_increment,b varchar(10));

#SQL[@149,N76]Result[]
create table rename_table_04(a int primary key auto_increment,b varchar(10));

#SQL[@150,N76]Result[]
create table rename_table_05(a int primary key auto_increment,b varchar(10));

#SQL[@151,N45]Result[]
insert into rename_table_01(b) values ('key');

#SQL[@152,N45]Result[]
insert into rename_table_02(b) values ('key');

#SQL[@153,N45]Result[]
insert into rename_table_03(b) values ('key');

#SQL[@154,N45]Result[]
insert into rename_table_04(b) values ('key');

#SQL[@155,N45]Result[]
insert into rename_table_05(b) values ('key');

#SQL[@157,N152]Result[]
rename table rename_table_01 to rename01,rename_table_02 to rename02,rename_table_03 to rename03,rename_table_04 to rename04,rename_table_05 to rename05;

#SQL[@158,N22]Result[8, 10]
select * from rename03;
a  ¦  b
1  ¦  key

