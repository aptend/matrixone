#SQL[@9,N36]Result[]
DROP TABLE IF EXISTS group_concat_01;

#SQL[@11,N189]Result[]
CREATE TABLE group_concat_01 (grp int,
                              a bigint unsigned,
                              c char(10) NOT NULL,
                              d char(10) NOT NULL);

#SQL[@16,N48]Result[]
INSERT INTO group_concat_01 VALUES (1,1,'a','a');

#SQL[@17,N48]Result[]
INSERT INTO group_concat_01 VALUES (2,2,'b','a');

#SQL[@18,N48]Result[]
INSERT INTO group_concat_01 VALUES (2,3,'c','b');

#SQL[@19,N48]Result[]
INSERT INTO group_concat_01 VALUES (3,4,'E','a');

#SQL[@20,N48]Result[]
INSERT INTO group_concat_01 VALUES (3,5,'C','b');

#SQL[@21,N48]Result[]
INSERT INTO group_concat_01 VALUES (3,6,'D','b');

#SQL[@22,N48]Result[]
INSERT INTO group_concat_01 VALUES (3,7,'d','d');

#SQL[@23,N48]Result[]
INSERT INTO group_concat_01 VALUES (3,8,'d','d');

#SQL[@24,N48]Result[]
INSERT INTO group_concat_01 VALUES (3,9,'D','c');

#SQL[@28,N60]Result[27, 8, 10, 18]
SELECT grp,group_concat(c) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ,)
1  ¦  a
2  ¦  b,c
3  ¦  E,C,D,d,d,D

#SQL[@29,N60]Result[27, 8, 10, 18]
SELECT grp,group_concat(c) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ,)
1  ¦  a
2  ¦  b,c
3  ¦  E,C,D,d,d,D

#SQL[@30,N62]Result[30, 9, 12, 24]
SELECT grp,group_concat(a,c) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(a, c, ,)
1  ¦  1a
2  ¦  2b,3c
3  ¦  4E,5C,6D,7d,8d,9D

#SQL[@31,N74]Result[39, 12, 18, 42]
SELECT grp,group_concat("(",a,":",c,")") FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat((, a, :, c, ), ,)
1  ¦  (1:a)
2  ¦  (2:b),(3:c)
3  ¦  (4:E),(5:C),(6:D),(7:d),(8:d),(9:D)

#SQL[@32,N63]Result[30, 11, 11, 11]
SELECT grp,group_concat(NULL) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(null, ,)
1  ¦  null
2  ¦  null
3  ¦  null

#SQL[@33,N65]Result[33, 11, 11, 11]
SELECT grp,group_concat(a,NULL) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(a, null, ,)
1  ¦  null
2  ¦  null
3  ¦  null

#SQL[@34,N46]Result[21, 4]
SELECT group_concat(NULL) FROM group_concat_01;
group_concat(null, ,)
null

#SQL[@35,N50]Result[27, 4]
SELECT group_concat(a,c,NULL) FROM group_concat_01;
group_concat(a, c, null, ,)
null

#SQL[@36,N48]Result[24, 4]
SELECT group_concat(a,NULL) FROM group_concat_01;
group_concat(a, null, ,)
null

#SQL[@40,N74]Result[27, 8, 10, 18]
SELECT grp,group_concat(c separator ",") FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ,)
1  ¦  a
2  ¦  b,c
3  ¦  E,C,D,d,d,D

#SQL[@41,N78]Result[31, 8, 14, 38]
SELECT grp,group_concat(c separator "---->") FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ---->)
1  ¦  a
2  ¦  b---->c
3  ¦  E---->C---->D---->d---->d---->D

#SQL[@42,N71]Result[37, 8, 10, 18]
SELECT grp,group_concat(c ORDER BY c) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ,order by c)
1  ¦  a
2  ¦  b,c
3  ¦  C,D,D,E,d,d

#SQL[@43,N76]Result[42, 8, 10, 18]
SELECT grp,group_concat(c ORDER BY c DESC) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ,order by c desc)
1  ¦  a
2  ¦  c,b
3  ¦  d,d,E,D,D,C

#SQL[@44,N71]Result[37, 8, 10, 18]
SELECT grp,group_concat(d ORDER BY a) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(d, ,order by a)
1  ¦  a
2  ¦  a,b
3  ¦  a,b,b,d,d,c

#SQL[@45,N76]Result[42, 8, 10, 18]
SELECT grp,group_concat(d ORDER BY a DESC) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(d, ,order by a desc)
1  ¦  a
2  ¦  b,a
3  ¦  c,d,d,b,b,a

#SQL[@46,N71]Result[37, 8, 10, 18]
SELECT grp,group_concat(c ORDER BY 1) FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ,order by 1)
1  ¦  a
2  ¦  b,c
3  ¦  C,D,D,E,d,d

#SQL[@47,N85]Result[37, 8, 10, 18]
SELECT grp,group_concat(c ORDER BY c separator ",") FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ,order by c)
1  ¦  a
2  ¦  b,c
3  ¦  C,D,D,E,d,d

#SQL[@48,N90]Result[42, 8, 10, 18]
SELECT grp,group_concat(c ORDER BY c DESC separator ",") FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(c, ,order by c desc)
1  ¦  a
2  ¦  c,b
3  ¦  d,d,E,D,D,C

#SQL[@49,N91]Result[44, 8, 10, 18]
SELECT grp,group_concat(c ORDER BY grp DESC) FROM group_concat_01 GROUP BY grp ORDER BY grp;
grp  ¦  group_concat(c, ,order by grp desc)
1  ¦  a
2  ¦  b,c
3  ¦  E,C,D,d,d,D

#SQL[@53,N76]Result[30, 8, 9, 13]
SELECT grp, group_concat(a separator "")+0 FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(a, ) + 0
1  ¦  1
2  ¦  23
3  ¦  456789

#SQL[@54,N78]Result[32, 8, 9, 13]
SELECT grp, group_concat(a separator "")+0.0 FROM group_concat_01 GROUP BY grp;
grp  ¦  group_concat(a, ) + 0.0
1  ¦  1
2  ¦  23
3  ¦  456789

#SQL[@55,N81]Result[33, 8, 9, 13]
SELECT grp, ROUND(group_concat(a separator "")) FROM group_concat_01 GROUP BY grp;
grp  ¦  ROUND(group_concat(a, ))
1  ¦  1
2  ¦  23
3  ¦  456789

#SQL[@59,N61]Error[58]
SELECT group_concat(sum(c)) FROM group_concat_02 group by grp;
SQL parser error: table \"group_concat_02\" does not exist

#SQL[@60,N71]Error[58]
SELECT grp,group_concat(c order by 2) FROM group_concat_02 group by grp;
SQL parser error: table \"group_concat_02\" does not exist

#SQL[@65,N36]Result[]
DROP TABLE IF EXISTS group_concat_03;

#SQL[@66,N36]Result[]
DROP TABLE IF EXISTS group_concat_04;

#SQL[@67,N63]Result[]
CREATE TABLE group_concat_03 ( URL_ID int(11), URL varchar(80));

#SQL[@68,N62]Result[]
CREATE TABLE group_concat_04 ( REQ_ID int(11), URL_ID int(11));

#SQL[@70,N53]Result[]
INSERT INTO group_concat_03 values (4,'www.host.com');

#SQL[@71,N55]Result[]
INSERT INTO group_concat_03 values (5,'www.google.com');

#SQL[@72,N53]Result[]
INSERT INTO group_concat_03 values (5,'www.help.com');

#SQL[@73,N40]Result[]
INSERT INTO group_concat_04 values (1,4);

#SQL[@74,N40]Result[]
INSERT INTO group_concat_04 values (5,4);

#SQL[@75,N40]Result[]
INSERT INTO group_concat_04 values (5,5);

#SQL[@77,N147]Result[15, 19, 47]
SELECT REQ_ID, group_concat(URL) AS URL FROM group_concat_03, group_concat_04 WHERE group_concat_04.URL_ID = group_concat_03.URL_ID group by REQ_ID;
REQ_ID  ¦  URL
1  ¦  www.host.com
5  ¦  www.host.com,www.google.com,www.help.com

#SQL[@82,N36]Result[]
DROP TABLE IF EXISTS group_concat_05;

#SQL[@83,N36]Result[]
DROP TABLE IF EXISTS group_concat_06;

#SQL[@84,N36]Result[]
CREATE TABLE group_concat_05(id int);

#SQL[@85,N36]Result[]
CREATE TABLE group_concat_06(id int);

#SQL[@86,N41]Result[]
INSERT INTO group_concat_05 values(0),(1);

#SQL[@89,N76]Result[35, 4]
SELECT group_concat(group_concat_05.id) FROM group_concat_05,group_concat_06;
group_concat(group_concat_05.id, ,)
null

#SQL[@94,N36]Result[]
DROP TABLE IF EXISTS group_concat_07;

#SQL[@95,N45]Result[]
CREATE TABLE group_concat_07(bar varchar(32));

#SQL[@96,N56]Result[]
INSERT INTO group_concat_07 values('tesgroup_concat_08');

#SQL[@97,N56]Result[]
INSERT INTO group_concat_07 values('tesgroup_concat_09');

#SQL[@98,N70]Result[45, 37]
SELECT group_concat(bar order by concat(bar,bar)) FROM group_concat_07;
group_concat(bar, ,order by concat(bar, bar))
tesgroup_concat_08,tesgroup_concat_09

#SQL[@99,N74]Result[49, 37]
SELECT group_concat(bar order by concat(bar,bar) ASC) FROM group_concat_07;
group_concat(bar, ,order by concat(bar, bar) asc)
tesgroup_concat_08,tesgroup_concat_09

#SQL[@102,N59]Error[119]
SELECT bar FROM group_concat_07 HAVING group_concat(bar)='';
SQL syntax error: column \"group_concat_07.bar\" must appear in the GROUP BY clause or be used in an aggregate function

#SQL[@103,N75]Error[119]
SELECT bar FROM group_concat_07 HAVING instr(group_concat(bar), "test") > 0;
SQL syntax error: column \"group_concat_07.bar\" must appear in the GROUP BY clause or be used in an aggregate function

#SQL[@104,N138]Error[119]
SELECT bar FROM group_concat_07 HAVING instr(group_concat(bar order by concat(bar,bar) desc), "tesgroup_concat_09,tesgroup_concat_08") > 0;
SQL syntax error: column \"group_concat_07.bar\" must appear in the GROUP BY clause or be used in an aggregate function

#SQL[@109,N36]Result[]
DROP TABLE IF EXISTS group_concat_08;

#SQL[@110,N36]Result[]
DROP TABLE IF EXISTS group_concat_09;

#SQL[@112,N79]Result[]
CREATE TABLE group_concat_08 (id1 tinyint(4) NOT NULL, id2 tinyint(4) NOT NULL);

#SQL[@113,N41]Result[]
INSERT INTO group_concat_08 VALUES (1, 1);

#SQL[@114,N41]Result[]
INSERT INTO group_concat_08 VALUES (1, 2);

#SQL[@115,N41]Result[]
INSERT INTO group_concat_08 VALUES (1, 3);

#SQL[@116,N41]Result[]
INSERT INTO group_concat_08 VALUES (1, 4);

#SQL[@117,N41]Result[]
INSERT INTO group_concat_08 VALUES (1, 5);

#SQL[@118,N41]Result[]
INSERT INTO group_concat_08 VALUES (2, 1);

#SQL[@119,N41]Result[]
INSERT INTO group_concat_08 VALUES (2, 2);

#SQL[@120,N41]Result[]
INSERT INTO group_concat_08 VALUES (2, 3);

#SQL[@122,N54]Result[]
CREATE TABLE group_concat_09 (id1 tinyint(4) NOT NULL);

#SQL[@123,N38]Result[]
INSERT INTO group_concat_09 VALUES (1);

#SQL[@124,N38]Result[]
INSERT INTO group_concat_09 VALUES (2);

#SQL[@125,N38]Result[]
INSERT INTO group_concat_09 VALUES (3);

#SQL[@126,N38]Result[]
INSERT INTO group_concat_09 VALUES (4);

#SQL[@127,N38]Result[]
INSERT INTO group_concat_09 VALUES (5);

#SQL[@129,N248]Result[18, 16]
SELECT group_concat_08.id1, GROUP_CONCAT(group_concat_08.id2 ORDER BY group_concat_08.id2 ASC) AS concat_id FROM group_concat_08, group_concat_09 WHERE group_concat_08.id1 = group_concat_09.id1 AND group_concat_08.id1=1 GROUP BY group_concat_08.id1;
id1  ¦  concat_id
1  ¦  1,2,3,4,5

#SQL[@130,N222]Result[18, 16, 12]
SELECT group_concat_08.id1, GROUP_CONCAT(group_concat_08.id2 ORDER BY group_concat_08.id2 ASC) AS concat_id FROM group_concat_08, group_concat_09 WHERE group_concat_08.id1 = group_concat_09.id1 GROUP BY group_concat_08.id1;
id1  ¦  concat_id
1  ¦  1,2,3,4,5
2  ¦  1,2,3

#SQL[@135,N36]Result[]
DROP TABLE IF EXISTS group_concat_10;

#SQL[@136,N59]Result[]
CREATE TABLE group_concat_10 (s1 char(10), s2 int not null);

#SQL[@137,N42]Result[]
INSERT INTO group_concat_10 values ('a',2);

#SQL[@138,N42]Result[]
INSERT INTO group_concat_10 values ('b',2);

#SQL[@139,N42]Result[]
INSERT INTO group_concat_10 values ('c',1);

#SQL[@140,N42]Result[]
INSERT INTO group_concat_10 values ('a',3);

#SQL[@141,N42]Result[]
INSERT INTO group_concat_10 values ('b',4);

#SQL[@142,N42]Result[]
INSERT INTO group_concat_10 values ('c',4);

#SQL[@145,N53]Result[28, 5]
SELECT group_concat(distinct s1) FROM group_concat_10;
group_concat(distinct s1, ,)
a,b,c

#SQL[@150,N36]Result[]
DROP TABLE IF EXISTS group_concat_11;

#SQL[@151,N36]Result[]
DROP TABLE IF EXISTS group_concat_12;

#SQL[@152,N43]Result[]
CREATE TABLE group_concat_11 (a int, c int);

#SQL[@153,N41]Result[]
INSERT INTO group_concat_11 values (1, 2);

#SQL[@154,N41]Result[]
INSERT INTO group_concat_11 values (2, 3);

#SQL[@155,N41]Result[]
INSERT INTO group_concat_11 values (2, 4);

#SQL[@156,N41]Result[]
INSERT INTO group_concat_11 values (3, 5);

#SQL[@158,N43]Result[]
CREATE TABLE group_concat_12 (a int, c int);

#SQL[@159,N41]Result[]
INSERT INTO group_concat_12 values (1, 5);

#SQL[@160,N41]Result[]
INSERT INTO group_concat_12 values (2, 4);

#SQL[@161,N41]Result[]
INSERT INTO group_concat_12 values (3, 3);

#SQL[@162,N41]Result[]
INSERT INTO group_concat_12 values (3, 3);

#SQL[@165,N43]Result[18, 7]
SELECT group_concat(c) FROM group_concat_11;
group_concat(c, ,)
2,3,4,5

#SQL[@166,N121]Result[8, 8, 8, 8, 8, 8]
SELECT group_concat_12.a,group_concat_12.c FROM group_concat_12,group_concat_11 where group_concat_12.a=group_concat_11.a;
a  ¦  c
1  ¦  5
2  ¦  4
2  ¦  4
3  ¦  3
3  ¦  3

#SQL[@167,N172]Error[48]
SELECT group_concat(c order by (SELECT mid(group_concat(c order by a),1,5) FROM group_concat_12 where group_concat_12.a=group_concat_11.a) desc) as grp FROM group_concat_11;
not supported: subquery in group_concat ORDER BY

#SQL[@172,N36]Result[]
DROP TABLE IF EXISTS group_concat_13;

#SQL[@173,N36]Result[]
DROP TABLE IF EXISTS group_concat_14;

#SQL[@174,N38]Result[]
CREATE TABLE group_concat_13 ( a int );

#SQL[@175,N38]Result[]
CREATE TABLE group_concat_14 ( a int );

#SQL[@176,N43]Result[]
INSERT INTO group_concat_13 VALUES (1), (2);

#SQL[@177,N43]Result[]
INSERT INTO group_concat_14 VALUES (1), (2);

#SQL[@180,N148]Result[80, 3, 3]
SELECT GROUP_CONCAT(group_concat_13.a*group_concat_14.a ORDER BY group_concat_14.a) FROM group_concat_13, group_concat_14 GROUP BY group_concat_13.a;
GROUP_CONCAT(group_concat_13.a * group_concat_14.a, ,order by group_concat_14.a)
1,2
2,4

#SQL[@185,N36]Result[]
DROP TABLE IF EXISTS group_concat_15;

#SQL[@186,N44]Result[]
CREATE TABLE group_concat_15 (a int, b text);

#SQL[@187,N44]Result[]
INSERT INTO group_concat_15 values (1, 'bb');

#SQL[@188,N45]Result[]
INSERT INTO group_concat_15 values (1, 'ccc');

#SQL[@189,N43]Result[]
INSERT INTO group_concat_15 values (1, 'a');

#SQL[@190,N44]Result[]
INSERT INTO group_concat_15 values (1, 'bb');

#SQL[@191,N45]Result[]
INSERT INTO group_concat_15 values (1, 'ccc');

#SQL[@192,N44]Result[]
INSERT INTO group_concat_15 values (2, 'BB');

#SQL[@193,N45]Result[]
INSERT INTO group_concat_15 values (2, 'CCC');

#SQL[@194,N43]Result[]
INSERT INTO group_concat_15 values (2, 'A');

#SQL[@195,N44]Result[]
INSERT INTO group_concat_15 values (2, 'BB');

#SQL[@196,N45]Result[]
INSERT INTO group_concat_15 values (2, 'CCC');

#SQL[@199,N54]Result[18, 15, 15]
SELECT group_concat(b) FROM group_concat_15 group by a;
group_concat(b, ,)
bb,ccc,a,bb,ccc
BB,CCC,A,BB,CCC

#SQL[@200,N63]Result[27, 8, 8]
SELECT group_concat(distinct b) FROM group_concat_15 group by a;
group_concat(distinct b, ,)
bb,ccc,a
BB,CCC,A

#SQL[@201,N54]Result[18, 15, 15]
SELECT group_concat(b) FROM group_concat_15 group by a;
group_concat(b, ,)
bb,ccc,a,bb,ccc
BB,CCC,A,BB,CCC

#SQL[@202,N63]Result[27, 8, 8]
SELECT group_concat(distinct b) FROM group_concat_15 group by a;
group_concat(distinct b, ,)
bb,ccc,a
BB,CCC,A

#SQL[@207,N36]Result[]
DROP TABLE IF EXISTS group_concat_16;

#SQL[@208,N36]Result[]
DROP TABLE IF EXISTS group_concat_17;

#SQL[@209,N379]Result[]
CREATE TABLE group_concat_16 (
                                 aID smallint(5) unsigned NOT NULL auto_increment,
                                 sometitle varchar(255) NOT NULL default '',
                                 bID smallint(5) unsigned NOT NULL,
                                 PRIMARY KEY  (aID),
                                 UNIQUE KEY sometitle (sometitle)
);

#SQL[@216,N61]Result[]
INSERT INTO group_concat_16 SET sometitle = 'title1', bID = 1;

#SQL[@217,N61]Result[]
INSERT INTO group_concat_16 SET sometitle = 'title2', bID = 1;

#SQL[@219,N308]Result[]
CREATE TABLE group_concat_17 (
                                 bID smallint(5) unsigned NOT NULL auto_increment,
                                 somename varchar(255) NOT NULL default '',
                                 PRIMARY KEY  (bID),
                                 UNIQUE KEY somename (somename)
);

#SQL[@225,N49]Result[]
INSERT INTO group_concat_17 SET somename = 'test';

#SQL[@228,N166]Result[65, 11]
SELECT COUNT(*), GROUP_CONCAT(DISTINCT group_concat_17.somename SEPARATOR ' |')
FROM group_concat_16 JOIN group_concat_17 ON group_concat_16.bID = group_concat_17.bID;
COUNT(*)  ¦  GROUP_CONCAT(distinct group_concat_17.somename,  |)
2  ¦  test

#SQL[@230,N63]Result[]
INSERT INTO group_concat_17 SET somename = 'tesgroup_concat_17';

#SQL[@231,N166]Result[65, 11]
SELECT COUNT(*), GROUP_CONCAT(DISTINCT group_concat_17.somename SEPARATOR ' |')
FROM group_concat_16 JOIN group_concat_17 ON group_concat_16.bID = group_concat_17.bID;
COUNT(*)  ¦  GROUP_CONCAT(distinct group_concat_17.somename,  |)
2  ¦  test

#SQL[@233,N65]Result[]
DELETE FROM group_concat_17 WHERE somename = 'tesgroup_concat_17';

#SQL[@234,N166]Result[65, 11]
SELECT COUNT(*), GROUP_CONCAT(DISTINCT group_concat_17.somename SEPARATOR ' |')
FROM group_concat_16 JOIN group_concat_17 ON group_concat_16.bID = group_concat_17.bID;
COUNT(*)  ¦  GROUP_CONCAT(distinct group_concat_17.somename,  |)
2  ¦  test

#SQL[@236,N24]Result[]
drop table if exists g18;

#SQL[@237,N24]Result[]
create table g18 (a int);

#SQL[@238,N42]Result[]
select group_concat(a order by a) from g18;

#SQL[@239,N24]Result[]
drop table if exists g18;

